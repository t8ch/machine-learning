<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#" style="min-height: 100%;" class=" js csstransforms3d csstransitions" lang="en-US"><head><script type="text/javascript" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/track"></script>
<meta charset="UTF-8">
<title>Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="pingback" href="http://machinelearningmastery.com/xmlrpc.php">

<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport">

<!-- This site is optimized with the Yoast SEO plugin v5.2 - https://yoast.com/wordpress/plugins/seo/ -->
<link rel="canonical" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/">
<link rel="publisher" href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery">
<meta property="og:description" content="Sequence classification is a predictive modeling problem where you have some sequence of inputs over space or time and the task is to predict a category for the sequence. What makes this problem difficult is that the sequences can vary in length, be comprised of a very large vocabulary of input symbols and may require …">
<meta property="og:url" content="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/">
<meta property="og:site_name" content="Machine Learning Mastery">
<meta property="article:publisher" content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/">
<meta property="article:section" content="Long Short-Term Memory Networks">
<meta property="article:published_time" content="2016-07-26T05:00:29+10:00">
<meta property="article:modified_time" content="2017-07-20T08:59:15+10:00">
<meta property="og:updated_time" content="2017-07-20T08:59:15+10:00">
<meta property="og:image" content="http://machinelearningmastery.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras.jpg">
<meta property="og:image:width" content="640">
<meta property="og:image:height" content="426">
<!-- / Yoast SEO plugin. -->

<link rel="dns-prefetch" href="http://cdnjs.cloudflare.com/">
<link rel="dns-prefetch" href="http://fonts.googleapis.com/">
<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Feed" href="http://feeds.feedburner.com/MachineLearningMastery">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Comments Feed" href="http://machinelearningmastery.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras Comments Feed" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/feed/">
		<script type="text/javascript" async="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/9556588.js"></script><script src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/296263687421164" async=""></script><script async="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/fbevents.js"></script><script async="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/analytics.js"></script><script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8.1"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b===c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/wp-emoji-release.js" type="text/javascript" defer="defer"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="crayon-css" href="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/crayon.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-classic-css" href="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/classic.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="apss-font-awesome-css" href="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/font-awesome.css" type="text/css" media="all">
<link rel="stylesheet" id="apss-font-opensans-css" href="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/css.css" type="text/css" media="all">
<link rel="stylesheet" id="apss-frontend-css-css" href="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/frontend.css" type="text/css" media="all">
<link rel="stylesheet" id="woo-testimonials-css-css" href="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/testimonials.css" type="text/css" media="all">
<link rel="stylesheet" id="theme-stylesheet-css" href="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/style.css" type="text/css" media="all">
<!--[if lt IE 9]>
<link href="http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="text/javascript" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/jquery.js"></script>
<script type="text/javascript" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/jquery-migrate.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/crayon.js"></script>
<script type="text/javascript" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/third-party.js"></script>
<script type="text/javascript" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/modernizr.js"></script>
<script type="text/javascript" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/general.js"></script>
<link rel="https://api.w.org/" href="http://machinelearningmastery.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://machinelearningmastery.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://machinelearningmastery.com/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="http://machinelearningmastery.com/?p=2938">
<link rel="alternate" type="application/json+oembed" href="http://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fmachinelearningmastery.com%2Fsequence-classification-lstm-recurrent-neural-networks-python-keras%2F">
<link rel="alternate" type="text/xml+oembed" href="http://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fmachinelearningmastery.com%2Fsequence-classification-lstm-recurrent-neural-networks-python-keras%2F&amp;format=xml">
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=296263687421164&ev=PageView&noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->

<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>

<!-- Woo Shortcodes CSS -->
<link href="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/shortcodes.css" rel="stylesheet" type="text/css">

<!-- Custom Stylesheet -->
<link href="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/custom.css" rel="stylesheet" type="text/css">

<!-- Theme version -->
<meta name="generator" content="Canvas 5.9.21">
<meta name="generator" content="WooFramework 6.2.9">
<link rel="icon" href="http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" sizes="32x32">
<link rel="icon" href="http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/09/cropped-icon-180x180.png">
<meta name="msapplication-TileImage" content="http://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-270x270.png">
<script src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/can-i-show.js"></script><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><style type="text/css">
  /* === Form-Specific Styles === */

  #drip-2211 .drip-content,
  #drip-2211 .drip-header {
    background: rgb(9,123,156) !important;
    background: rgba(9,123,156,0.90) !important;
  }

  #drip-2211 .drip-content h3 {
    color: #333333 !important;
    font-size: 21px !important;
  }

  #drip-2211 .drip-submit-button {
    background-color: #333333 !important;
    font-size: 12px !important;
  }

  #drip-2211 .drip-submit-button:hover {
    background-color: #191919 !important;
  }

  #drip-2211 .drip-submit-button:active {
    background-color: #000000 !important;
  }

  #drip-2211 dl dt,
  #drip-2211 .drip-content .drip-description,
  #drip-2211 .drip-errors {
    font-size: 13px !important;
  }

  #drip-2211 .drip-text-field {
    font-size: 14px !important;
  }

  /* === Reset styles === */

  .drip-tab h1,
  .drip-tab h2,
  .drip-tab h3,
  .drip-tab div,
  .drip-tab dl,
  .drip-tab dt,
  .drip-tab dd,
  .drip-tab p,
  .drip-tab a,
  .drip-tab .drip-text-field,
  .drip-tab .drip-text-field:focus,
  .drip-tab .drip-submit-button {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    float: none;
    width: auto;
    background-image: none;
    letter-spacing: 0;
    -webkit-box-shadow: none;
       -moz-box-shadow: none;
            box-shadow: none;
    -webkit-text-shadow: none !important;
       -moz-text-shadow: none !important;
            text-shadow: none !important;
  }

  .drip-tab a {
    text-decoration: none;
  }

  .drip-tab :focus {
    outline: 0;
  }

  /* === Clearfix === */

  .drip-clearfix:after {
    visibility: hidden;
    display: block;
    font-size: 0;
    content: " ";
    clear: both;
    height: 0;
  }
  * html .drip-clearfix             { zoom: 1; } /* IE6 */
  *:first-child+html .drip-clearfix { zoom: 1; } /* IE7 */

  /* === Main Container === */

  .drip-tab-container * {
    box-sizing: content-box;
  }

  /* === Content === */

  .drip-tab .drip-content {
    margin: 0;
    padding: 5px;
    width: 330px;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    box-sizing: border-box;
    -webkit-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
       -moz-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
            box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
  }

  .drip-tab.bottom .drip-content {
    bottom: -800px;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom.left .drip-content {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-content {
    right: 40px;
  }

  .drip-tab.image-left .drip-content,
  .drip-tab.image-right .drip-content {
    width: 510px;
  }

  .drip-tab.side .drip-content {
    top: 10%;
  }

  .drip-tab.side.right .drip-content {
    right: -550px;
    -webkit-border-radius: 8px 0 0 8px;
       -moz-border-radius: 8px 0 0 8px;
            border-radius: 8px 0 0 8px;
    -webkit-transition: right 200ms ease-in;
       -moz-transition: right 200ms ease-in;
         -o-transition: right 200ms ease-in;
            transition: right 200ms ease-in;
  }

  .drip-tab.side.left .drip-content {
    left: -550px;
    -webkit-border-radius: 0 8px 8px 0;
       -moz-border-radius: 0 8px 8px 0;
            border-radius: 0 8px 8px 0;
    -webkit-transition: left 200ms ease-in;
       -moz-transition: left 200ms ease-in;
         -o-transition: left 200ms ease-in;
            transition: left 200ms ease-in;
  }

  .drip-tab.mobile .drip-content {
    width: 100% !important;
    bottom: -800px;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.drip-scrollable .drip-content {
    overflow-y: scroll;
  }

  /* === Header === */

  .drip-tab .drip-header {
    margin: 0;
    padding: 0;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
       -moz-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
            box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
  }

  .drip-tab.bottom .drip-header {
    width: 330px;
    bottom: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom .drip-header.drip-hidden {
    bottom: -800px;
  }

  .drip-tab.bottom.left .drip-header {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-header {
    right: 40px;
  }

  .drip-tab.bottom.image-left .drip-header,
  .drip-tab.bottom.image-right .drip-header {
    width: 510px;
  }

  .drip-tab.side .drip-header {
    width: 330px;
    top: 10%;
  }

  .drip-tab.side.right .drip-header {
    right: -100px;
    -webkit-transition: right 400ms ease-in;
       -moz-transition: right 400ms ease-in;
         -o-transition: right 400ms ease-in;
            transition: right 400ms ease-in;
    -webkit-transform: rotate(-90deg) !important;
       -moz-transform: rotate(-90deg) !important;
        -ms-transform: rotate(-90deg) !important;
         -o-transform: rotate(-90deg) !important;
            transform: rotate(-90deg) !important;
    -webkit-transform-origin: right center;
       -moz-transform-origin: right center;
         -o-transform-origin: right center;
            transform-origin: right center;
  }

  .drip-tab.side.right .drip-header.drip-hidden {
    right: -100px;
  }

  .drip-tab.side.left .drip-header {
    left: -100px;
    -webkit-transition: left 400ms ease-in;
       -moz-transition: left 400ms ease-in;
         -o-transition: left 400ms ease-in;
            transition: left 400ms ease-in;
    -webkit-transform: rotate(90deg) !important;
       -moz-transform: rotate(90deg) !important;
        -ms-transform: rotate(90deg) !important;
         -o-transform: rotate(90deg) !important;
            transform: rotate(90deg) !important;
    -webkit-transform-origin: left center;
       -moz-transform-origin: left center;
         -o-transform-origin: left center;
            transform-origin: left center;
  }

  .drip-tab.side.left .drip-header.drip-hidden {
    left: -100px;
  }

  .drip-tab.mobile .drip-header {
    width: 100% !important;
    bottom: 0;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.mobile .drip-header.drip-hidden {
    bottom: -300px;
  }

  /* === Header Toggle === */

  .drip-tab .drip-toggle {
    display: block;
    text-decoration: none;
    padding: 10px 50px 10px 20px; /* extra padding for the arrow */
  }

  /* === Teaser === */

  .drip-tab .drip-header h2 {
    display: block;
    margin: 0 !important;
    padding: 0 !important;
    border: 0 !important;
    font-size: 14px !important;
    line-height: 1.5 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #fff !important;
    clear: none !important;
    letter-spacing: 0 !important;
    width: auto !important;
  }

  /* === Arrows === */

  .drip-tab .drip-header span.drip-arrow {
    display: block;
    position: absolute;
    margin: 0;
    padding: 0;
    width: 0;
    height: 0;
    line-height: 0;
    top: 17px;
    right: 32px;
  }

  /* === Panel === */

  .drip-tab .drip-content > div.drip-panel {
    padding: 15px;
    background-color: #fff;
    -webkit-border-radius: 6px;
       -moz-border-radius: 6px;
            border-radius: 6px;
  }

  /* === Powered By === */

  .drip-tab .drip-powered-by {
    padding: 8px;
    margin-bottom: -5px;
    font-family: Helvetica, Arial, sans-serif;
    text-align: left;
    font-weight: bold;
    font-size: 10px;
    line-height: 16px;
    color: #ffffff;
    letter-spacing: 1px;
    text-align: center;
    text-transform: uppercase;
  }

  .drip-tab .drip-powered-by a {
    color: #ffffff !important;
    text-decoration: underline !important;
    letter-spacing: 1px;
  }

  /* === Content Headings & Paragraphs === */

  .drip-tab .drip-content h3 {
    display: block;
    margin: 0 20px 0 0 !important;
    padding: 0 0 15px 0 !important;
    line-height: 1.4 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #4477bd !important;
    clear: none !important;
  }

  .drip-tab .drip-content .drip-description {
    margin: 0;
    padding: 0 0 20px 0;
    line-height: 1.6;
    text-align: left;
  }

  .drip-tab.image-left .drip-content .drip-description {
    margin-left: 170px;
  }

  .drip-tab.image-right .drip-content .drip-description {
    margin-right: 170px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content .drip-description {
      margin-left: 0; /* 120px; */
    }

    .drip-tab.image-right .drip-content .drip-description {
      margin-right: 0; /* 120px; */
    }
  }

  .drip-tab .drip-content .drip-description a {
    text-decoration: underline;
  }

  .drip-tab .drip-content .drip-description em {
    font-style: italic;
  }

  .drip-tab .drip-content .drip-description ul,
  .drip-tab .drip-content .drip-description ol {
    list-style-position: outside;
    margin: 8px 0 8px 30px;
  }

  .drip-tab .drip-content .drip-description ul li
  .drip-tab .drip-content .drip-description ol li {
    padding: 0;
  }

  .drip-tab .drip-content img.drip-image {
    margin-bottom: 20px;
  }

  .drip-tab.image-left .drip-content img.drip-image {
    float: left;
    width: 150px;
  }

  .drip-tab.image-right .drip-content img.drip-image {
    float: right;
    width: 150px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content img.drip-image {
      margin-right: 20px;
      width: 100px;
    }

    .drip-tab.image-right .drip-content img.drip-image {
      margin-left: 20px;
      width: 100px;
    }
  }

  .drip-tab .drip-content a.drip-close {
    font-family: Arial, Helvetica, sans-serif;
    margin: -1px 0 0 0;
    float: right;
    font-size: 28px;
    line-height: 15px;
    font-weight: normal;
    color: #333;
    opacity: 0.4;
  }

  .drip-tab .drip-content a.drip-close:hover {
    text-decoration: none;
    cursor: pointer;
    opacity: 0.6;
  }

  /* === Content Subscribe Form === */

  .drip-tab form {
    margin: 0 !important;
    padding: 0 !important;
  }

  .drip-tab dl {
    display: block;
    margin: 0;
    padding: 0;
  }

  .drip-tab dl dt {
    display: block;
    padding: 0 0 5px 0;
    font-weight: bold;
  }

  .drip-tab dl.no-labels dt {
    display: none;
  }

  .drip-tab dl dd {
    display: block;
    padding: 0 0 10px 0;
  }

  .drip-tab .drip-text-field {
    margin: 0 !important;
    padding: 6px !important;
    height: auto !important;
    width: 100% !important;
    color: #333 !important;
    background-color: #fff !important;
    border: 1px solid #c4c4c4 !important;
    -webkit-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
       -moz-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
            box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
    -webkit-border-radius: 4px !important;
       -moz-border-radius: 4px !important;
            border-radius: 4px !important;
    -webkit-box-sizing: border-box !important;
       -moz-box-sizing: border-box !important;
        -ms-box-sizing: border-box !important;
            box-sizing: border-box !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
  }

  .drip-tab .drip-text-field::-webkit-input-placeholder { /* WebKit browsers */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field::-moz-placeholder { /* Mozilla Firefox 19+ */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-ms-input-placeholder { /* Internet Explorer 10+ */
    color: #999999 !important;
  }

  .drip-tab .drip-text-field:focus {
    border-color: #a4a4a4 !important;
    outline: 0;
    background-image: none;
    background-color: #fff !important;
  }

  .drip-tab.mobile .drip-text-field {
    font-size: 16px;
  }

  .drip-tab .drip-errors {
    padding: 5px 0 0 0;
    font-weight: normal;
    color: red;
  }

  .drip-tab .drip-submit-button {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif !important;
    padding: 3px 12px !important;
    color: #ffffff !important;
    font-weight: bold !important;
    line-height: 1.6 !important;
    border: 0 !important;
    -webkit-border-radius: 15px !important;
       -moz-border-radius: 15px !important;
            border-radius: 15px !important;
    cursor: pointer !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
    height: auto;
  }

  .drip-tab .drip-submit-button:hover {
    background-image: none !important;
  }

  .drip-tab .drip-submit-button:active {
    background-image: none !important;
  }

</style></head>
<body class="post-template-default single single-post postid-2938 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">

	<div id="inner-wrapper">

	<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="http://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/MachineLearningMastery.png" alt="Machine Learning Mastery"></a>
<span class="site-title"><a href="http://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
	    <div class="header-widget">
	        <div id="text-3" class="widget widget_text">			<div class="textwidget"><br>
<div style="font-size:12pt;">
<a href="http://machinelearningmastery.com/start-here"><strong>Start Here</strong></a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="http://machinelearningmastery.com/blog">Blog</a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="http://machinelearningmastery.com/products">Books</a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="http://machinelearningmastery.com/about">About</a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="http://machinelearningmastery.com/contact">Contact</a>
</div></div>
		</div><div id="search-3" class="widget widget_search"><div class="search_main">
    <form method="get" class="searchform" action="http://machinelearningmastery.com/">
        <input class="field s" name="s" value="Search..." onfocus="if (this.value == 'Search...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search...';}" type="text">
        <button type="submit" class="fa fa-search submit" name="submit" value="Search"></button>
    </form>
    <div class="fix"></div>
</div></div><div id="text-31" class="widget widget_text">			<div class="textwidget"><p>Need help with LSTMs in Python? <a href="https://machinelearningmastery.lpages.co/lnwp-mini-course/">Take the FREE Mini-Course</a>.</p>
</div>
		</div>	    </div>
	
	</header>
	<nav id="navigation" class="col-full" role="navigation">

	
	<section class="menus">

		<a href="http://machinelearningmastery.com/" class="nav-home"><span>Home</span></a>

	<h3>Empty Menu</h3>	<div class="side-nav">
		</div><!-- /#side-nav -->

	</section><!-- /.menus -->

	<a href="#top" class="nav-close"><span>Return to Content</span></a>

</nav>
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-2938 post type-post status-publish format-standard has-post-thumbnail hentry category-lstm">
	<header>
	<h1 class="title entry-title">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="http://machinelearningmastery.com/author/jasonb/" title="Posts by Jason Brownlee" rel="author">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-07-26T05:00:29+1000">July 26, 2016</abbr>  <span class="small">in</span> <span class="categories"><a href="http://machinelearningmastery.com/category/lstm/" title="View all items in Long Short-Term Memory Networks">Long Short-Term Memory Networks</a></span>  </div>
	<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">


				<div class="apss-twitter apss-single-icon">
					<a rel="nofollow" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras&amp;url=http%3A%2F%2Fmachinelearningmastery.com%2Fsequence-classification-lstm-recurrent-neural-networks-python-keras%2F&amp;');" href="javascript:void(0);" title="Share on Twitter" target="">
						<div class="apss-icon-block clearfix">
							<i class="fa fa-twitter"></i>
							<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
						</div>
											</a>
				</div>
								<div class="apss-facebook apss-single-icon">
					<a rel="nofollow" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/');" title="Share on Facebook" target="" href="https://www.facebook.com/sharer/sharer.php?u=http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/">
						<div class="apss-icon-block clearfix">
							<i class="fa fa-facebook"></i>
							<span class="apss-social-text">Share on Facebook</span>
							<span class="apss-share">Share</span>
						</div>
											</a>
				</div>
				
				<div class="apss-linkedin apss-single-icon">
					<a rel="nofollow" onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras&amp;url=http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/&amp;summary=Sequence+classification+is+a+predictive+modeling+problem+where+you+have+some+sequence+of+inputs+over...');" title="Share on LinkedIn" target="" href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras&amp;url=http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/&amp;summary=Sequence+classification+is+a+predictive+modeling+problem+where+you+have+some+sequence+of+inputs+over...">
						<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
							<span class="apss-social-text">Share on LinkedIn</span>
							<span class="apss-share">Share</span>
						</div>
											</a>
				</div>
								<div class="apss-google-plus apss-single-icon">
					<a rel="nofollow" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/');" title="Share on Google Plus" target="" href="https://plus.google.com/share?url=http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/">
						<div class="apss-icon-block clearfix">
							<i class="fa fa-google-plus"></i>
							<span class="apss-social-text">Share on Google Plus</span>
							<span class="apss-share">Share</span>
						</div>
											</a>
				</div>
				</div><p>Sequence classification is a predictive modeling problem 
where you have some sequence of inputs over space or time and the task 
is to predict a category for the sequence.</p>
<p>What makes this problem difficult is that the sequences can vary in 
length, be comprised of a very large vocabulary of input symbols and may
 require the model to learn the long-term context or dependencies 
between symbols in the input sequence.</p>
<p>In this post, you will discover how you can develop LSTM recurrent 
neural network models for sequence classification problems in Python 
using the Keras deep learning library.</p>
<p>After reading this post you will know:</p>
<ul>
<li>How to develop an LSTM model for a sequence classification problem.</li>
<li>How to reduce overfitting in your LSTM models through the use of dropout.</li>
<li>How to combine LSTM models with Convolutional Neural Networks that excel at learning spatial relationships.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Oct/2016</strong>: Updated examples for Keras 1.1.0 andTensorFlow 0.10.0.</li>
<li><strong>Update Mar/2017</strong>: Updated example for Keras 2.0.2, TensorFlow 1.0.1 and Theano 0.9.0.</li>
</ul>
<div id="attachment_2939" style="width: 650px" class="wp-caption aligncenter"><img class="size-full wp-image-2939" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-.jpg" alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" srcset="http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras.jpg 640w, http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-300x200.jpg 300w" sizes="(max-width: 640px) 100vw, 640px" height="426" width="640"><p class="wp-caption-text">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras<br>Photo by <a href="https://www.flickr.com/photos/photophilde/4875287879/">photophilde</a>, some rights reserved.</p></div>
<h2>Problem Description</h2>
<p>The problem that we will use to demonstrate sequence learning in this tutorial is the <a href="http://ai.stanford.edu/%7Eamaas/data/sentiment/">IMDB movie review sentiment classification problem</a>. Each movie review is a variable sequence of words and the sentiment of each movie review must be classified.</p>
<p>The Large Movie Review Dataset (often referred to as the IMDB 
dataset) contains 25,000 highly-polar movie reviews (good or bad) for 
training and the same amount again for testing. The problem is to 
determine whether a given movie&nbsp;review has a positive or negative 
sentiment.</p>
<p>The data was collected by <a href="http://ai.stanford.edu/%7Eamaas/papers/wvSent_acl2011.pdf">Stanford researchers and was used in a 2011 paper</a> where a split of 50-50 of the data was used for training and test. An accuracy of 88.89% was achieved.</p>
<p>Keras provides access to the IMDB dataset built-in. The <strong>imdb.load_data()</strong> function allows you to load the dataset in a format that is ready for use in neural network and deep learning models.</p>
<p>The words have been replaced by integers that indicate the ordered 
frequency of each word in the dataset. The sentences in each review are 
therefore comprised of a sequence of integers.</p>
<h3>Word Embedding</h3>
<p>We will map each movie review into a real vector domain, a popular 
technique when working with text called word embedding. This is a 
technique where words are encoded as real-valued vectors in a high 
dimensional space, where the similarity between words in terms of 
meaning translates to closeness in the vector space.</p>
<p>Keras provides a convenient way to convert positive integer 
representations of words into a word embedding by an Embedding layer.</p>
<p>We will map each word onto a 32 length real valued vector. We will 
also limit the total number of words that we are interested in modeling 
to the 5000 most frequent words, and zero out the rest. Finally, the 
sequence length (number of words) in each review varies, so we will 
constrain each review to be 500 words, truncating long reviews and pad 
the shorter reviews with zero values.</p>
<p>Now that we have defined our problem and how the data will be 
prepared and modeled, we are ready to develop an LSTM model to classify 
the sentiment of movie reviews.</p>
<!-- Start shortcoder --><div class="woo-sc-hr"></div>
<center>
<h3>Need help with LSTMs for Sequence Prediction?</h3>
<p>Take my free 7-day email course and discover 6 different LSTM architectures (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a style="background: #ffce0a; color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" href="https://machinelearningmastery.lpages.co/leadbox/1403a9373f72a2%3A164f8be4f346dc/5754903989321728/" target="_blank" rel="noopener" data-leadbox="https://machinelearningmastery.lpages.co/leadbox/1403a9373f72a2%3A164f8be4f346dc/5754903989321728/" data-leadbox-id="1403a9373f72a2:164f8be4f346dc">Start Your FREE Mini-Course Now!</a><script data-leadbox="1403a9373f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.lpages.co/leadbox/1403a9373f72a2%3A164f8be4f346dc/5754903989321728/" data-config="%7B%7D" type="text/javascript" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/leadbox-1500400021.js"></script></p>
</center>
<div class="woo-sc-hr"></div><!-- End shortcoder v4.0.3-->
<h2>Simple LSTM for Sequence Classification</h2>
<p>We can quickly develop a small LSTM for the IMDB problem and achieve good accuracy.</p>
<p>Let’s start off by importing the classes and functions required for 
this model and initializing the random number generator to a constant 
value to ensure we can easily reproduce the results.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb96c501715022524" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">import numpy
from keras.datasets import imdb
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from keras.layers.embeddings import Embedding
from keras.preprocessing import sequence
# fix random seed for reproducibility
numpy.random.seed(7)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb96c501715022524-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c501715022524-2">2</div><div class="crayon-num" data-line="crayon-5996dbb96c501715022524-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c501715022524-4">4</div><div class="crayon-num" data-line="crayon-5996dbb96c501715022524-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c501715022524-6">6</div><div class="crayon-num" data-line="crayon-5996dbb96c501715022524-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c501715022524-8">8</div><div class="crayon-num" data-line="crayon-5996dbb96c501715022524-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb96c501715022524-1"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c501715022524-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">imdb</span></div><div class="crayon-line" id="crayon-5996dbb96c501715022524-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c501715022524-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5996dbb96c501715022524-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c501715022524-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">embeddings </span><span class="crayon-e">import </span><span class="crayon-e">Embedding</span></div><div class="crayon-line" id="crayon-5996dbb96c501715022524-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-v">sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c501715022524-8"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line" id="crayon-5996dbb96c501715022524-9"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>We need to load the IMDB dataset. We are constraining the dataset to 
the top 5,000 words. We also split the dataset into train (50%) and test
 (50%) sets.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb96c50e654523482" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># load the dataset but only keep the top n words, zero the rest
top_words = 5000
(X_train, y_train), (X_test, y_test) = imdb.load_data(num_words=top_words)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb96c50e654523482-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c50e654523482-2">2</div><div class="crayon-num" data-line="crayon-5996dbb96c50e654523482-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb96c50e654523482-1"><span class="crayon-p"># load the dataset but only keep the top n words, zero the rest</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c50e654523482-2"><span class="crayon-v">top_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span></div><div class="crayon-line" id="crayon-5996dbb96c50e654523482-3"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imdb</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-v">num_words</span><span class="crayon-o">=</span><span class="crayon-v">top_words</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Next, we need to truncate and pad the input sequences so that they 
are all the same length for modeling. The model will learn the zero 
values carry no information so indeed the sequences are not the same 
length in terms of content, but same length vectors is required to 
perform the computation in Keras.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb96c513990477850" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># truncate and pad input sequences
max_review_length = 500
X_train = sequence.pad_sequences(X_train, maxlen=max_review_length)
X_test = sequence.pad_sequences(X_test, maxlen=max_review_length)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb96c513990477850-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c513990477850-2">2</div><div class="crayon-num" data-line="crayon-5996dbb96c513990477850-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c513990477850-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb96c513990477850-1"><span class="crayon-p"># truncate and pad input sequences</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c513990477850-2"><span class="crayon-v">max_review_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">500</span></div><div class="crayon-line" id="crayon-5996dbb96c513990477850-3"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c513990477850-4"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>We can now define, compile and fit our LSTM model.</p>
<p>The first layer is the Embedded layer that uses 32 length vectors to 
represent each word. The next layer is the LSTM layer with 100 memory 
units (smart neurons). Finally, because this is a classification problem
 we use a Dense output layer with a single neuron and a sigmoid 
activation function to make 0 or 1 predictions for the two classes (good
 and bad) in the problem.</p>
<p>Because it is a binary classification problem, log loss is used as the loss function (<strong>binary_crossentropy</strong>
 in Keras). The efficient ADAM optimization algorithm is used. The model
 is fit for only 2 epochs because it quickly overfits the problem. A 
large batch size of 64 reviews is used to space out weight updates.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb96c518035052033" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># create the model
embedding_vecor_length = 32
model = Sequential()
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))
model.add(LSTM(100))
model.add(Dense(1, activation='sigmoid'))
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
print(model.summary())
model.fit(X_train, y_train, validation_data=(X_test, y_test), epochs=3, batch_size=64)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb96c518035052033-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c518035052033-2">2</div><div class="crayon-num" data-line="crayon-5996dbb96c518035052033-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c518035052033-4">4</div><div class="crayon-num" data-line="crayon-5996dbb96c518035052033-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c518035052033-6">6</div><div class="crayon-num" data-line="crayon-5996dbb96c518035052033-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c518035052033-8">8</div><div class="crayon-num" data-line="crayon-5996dbb96c518035052033-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb96c518035052033-1"><span class="crayon-p"># create the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c518035052033-2"><span class="crayon-v">embedding_vecor_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">32</span></div><div class="crayon-line" id="crayon-5996dbb96c518035052033-3"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c518035052033-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">top_words</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vecor_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c518035052033-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c518035052033-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c518035052033-7"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c518035052033-8"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c518035052033-9"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Once fit, we estimate the performance of the model on unseen reviews.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb96c51c770004218" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># Final evaluation of the model
scores = model.evaluate(X_test, y_test, verbose=0)
print("Accuracy: %.2f%%" % (scores[1]*100))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb96c51c770004218-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c51c770004218-2">2</div><div class="crayon-num" data-line="crayon-5996dbb96c51c770004218-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb96c51c770004218-1"><span class="crayon-p"># Final evaluation of the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c51c770004218-2"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c51c770004218-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Accuracy: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>For completeness, here is the full&nbsp;code listing for this LSTM network on the IMDB dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb96c51f487490888" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># LSTM for sequence classification in the IMDB dataset
import numpy
from keras.datasets import imdb
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from keras.layers.embeddings import Embedding
from keras.preprocessing import sequence
# fix random seed for reproducibility
numpy.random.seed(7)
# load the dataset but only keep the top n words, zero the rest
top_words = 5000
(X_train, y_train), (X_test, y_test) = imdb.load_data(nb_words=top_words)
# truncate and pad input sequences
max_review_length = 500
X_train = sequence.pad_sequences(X_train, maxlen=max_review_length)
X_test = sequence.pad_sequences(X_test, maxlen=max_review_length)
# create the model
embedding_vecor_length = 32
model = Sequential()
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))
model.add(LSTM(100))
model.add(Dense(1, activation='sigmoid'))
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
print(model.summary())
model.fit(X_train, y_train, nb_epoch=3, batch_size=64)
# Final evaluation of the model
scores = model.evaluate(X_test, y_test, verbose=0)
print("Accuracy: %.2f%%" % (scores[1]*100))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb96c51f487490888-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c51f487490888-2">2</div><div class="crayon-num" data-line="crayon-5996dbb96c51f487490888-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c51f487490888-4">4</div><div class="crayon-num" data-line="crayon-5996dbb96c51f487490888-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c51f487490888-6">6</div><div class="crayon-num" data-line="crayon-5996dbb96c51f487490888-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c51f487490888-8">8</div><div class="crayon-num" data-line="crayon-5996dbb96c51f487490888-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c51f487490888-10">10</div><div class="crayon-num" data-line="crayon-5996dbb96c51f487490888-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c51f487490888-12">12</div><div class="crayon-num" data-line="crayon-5996dbb96c51f487490888-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c51f487490888-14">14</div><div class="crayon-num" data-line="crayon-5996dbb96c51f487490888-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c51f487490888-16">16</div><div class="crayon-num" data-line="crayon-5996dbb96c51f487490888-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c51f487490888-18">18</div><div class="crayon-num" data-line="crayon-5996dbb96c51f487490888-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c51f487490888-20">20</div><div class="crayon-num" data-line="crayon-5996dbb96c51f487490888-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c51f487490888-22">22</div><div class="crayon-num" data-line="crayon-5996dbb96c51f487490888-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c51f487490888-24">24</div><div class="crayon-num" data-line="crayon-5996dbb96c51f487490888-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c51f487490888-26">26</div><div class="crayon-num" data-line="crayon-5996dbb96c51f487490888-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c51f487490888-28">28</div><div class="crayon-num" data-line="crayon-5996dbb96c51f487490888-29">29</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb96c51f487490888-1"><span class="crayon-p"># LSTM for sequence classification in the IMDB dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c51f487490888-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5996dbb96c51f487490888-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">imdb</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c51f487490888-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5996dbb96c51f487490888-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c51f487490888-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5996dbb96c51f487490888-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">embeddings </span><span class="crayon-e">import </span><span class="crayon-e">Embedding</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c51f487490888-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-v">sequence</span></div><div class="crayon-line" id="crayon-5996dbb96c51f487490888-9"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c51f487490888-10"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c51f487490888-11"><span class="crayon-p"># load the dataset but only keep the top n words, zero the rest</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c51f487490888-12"><span class="crayon-v">top_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span></div><div class="crayon-line" id="crayon-5996dbb96c51f487490888-13"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imdb</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-v">nb_words</span><span class="crayon-o">=</span><span class="crayon-v">top_words</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c51f487490888-14"><span class="crayon-p"># truncate and pad input sequences</span></div><div class="crayon-line" id="crayon-5996dbb96c51f487490888-15"><span class="crayon-v">max_review_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">500</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c51f487490888-16"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c51f487490888-17"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c51f487490888-18"><span class="crayon-p"># create the model</span></div><div class="crayon-line" id="crayon-5996dbb96c51f487490888-19"><span class="crayon-v">embedding_vecor_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">32</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c51f487490888-20"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c51f487490888-21"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">top_words</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vecor_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c51f487490888-22"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c51f487490888-23"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c51f487490888-24"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c51f487490888-25"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c51f487490888-26"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nb_epoch</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c51f487490888-27"><span class="crayon-p"># Final evaluation of the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c51f487490888-28"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c51f487490888-29"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Accuracy: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0019 seconds] -->
<p>Running this example produces the following output.</p>
<p>Note,&nbsp;if you are using a TensorFlow backend, you may see some 
warning messages related to “PoolAllocator”, that you can ignore for 
now.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb96c524824005664" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">Epoch 1/3
16750/16750 [==============================] - 107s - loss: 0.5570 - acc: 0.7149
Epoch 2/3
16750/16750 [==============================] - 107s - loss: 0.3530 - acc: 0.8577
Epoch 3/3
16750/16750 [==============================] - 107s - loss: 0.2559 - acc: 0.9019
Accuracy: 86.79%</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb96c524824005664-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c524824005664-2">2</div><div class="crayon-num" data-line="crayon-5996dbb96c524824005664-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c524824005664-4">4</div><div class="crayon-num" data-line="crayon-5996dbb96c524824005664-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c524824005664-6">6</div><div class="crayon-num" data-line="crayon-5996dbb96c524824005664-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb96c524824005664-1">Epoch 1/3</div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c524824005664-2">16750/16750 [==============================] - 107s - loss: 0.5570 - acc: 0.7149</div><div class="crayon-line" id="crayon-5996dbb96c524824005664-3">Epoch 2/3</div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c524824005664-4">16750/16750 [==============================] - 107s - loss: 0.3530 - acc: 0.8577</div><div class="crayon-line" id="crayon-5996dbb96c524824005664-5">Epoch 3/3</div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c524824005664-6">16750/16750 [==============================] - 107s - loss: 0.2559 - acc: 0.9019</div><div class="crayon-line" id="crayon-5996dbb96c524824005664-7">Accuracy: 86.79%</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>You can see that this simple LSTM with little tuning achieves near 
state-of-the-art results on the IMDB problem. Importantly, this is a 
template that you can use to apply LSTM networks to your own sequence 
classification problems.</p>
<p>Now, let’s look at some extensions of this simple model that you may also want to bring to your own problems.</p>
<h2>LSTM For Sequence Classification With Dropout</h2>
<p>Recurrent Neural networks like LSTM generally have the problem of overfitting.</p>
<p>Dropout can be applied between layers using the Dropout Keras layer. 
We can do this easily by adding new Dropout layers between the Embedding
 and LSTM layers and the LSTM and Dense output layers. For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb96c529595894863" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">model = Sequential()
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))
model.add(Dropout(0.2))
model.add(LSTM(100))
model.add(Dropout(0.2))
model.add(Dense(1, activation='sigmoid'))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb96c529595894863-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c529595894863-2">2</div><div class="crayon-num" data-line="crayon-5996dbb96c529595894863-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c529595894863-4">4</div><div class="crayon-num" data-line="crayon-5996dbb96c529595894863-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c529595894863-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb96c529595894863-1"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c529595894863-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">top_words</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vecor_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c529595894863-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c529595894863-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c529595894863-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c529595894863-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>The full&nbsp;code listing example above with the addition of Dropout layers is as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb96c52f381040208" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># LSTM with Dropout for sequence classification in the IMDB dataset
import numpy
from keras.datasets import imdb
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from keras.layers import Dropout
from keras.layers.embeddings import Embedding
from keras.preprocessing import sequence
# fix random seed for reproducibility
numpy.random.seed(7)
# load the dataset but only keep the top n words, zero the rest
top_words = 5000
(X_train, y_train), (X_test, y_test) = imdb.load_data(num_words=top_words)
# truncate and pad input sequences
max_review_length = 500
X_train = sequence.pad_sequences(X_train, maxlen=max_review_length)
X_test = sequence.pad_sequences(X_test, maxlen=max_review_length)
# create the model
embedding_vecor_length = 32
model = Sequential()
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))
model.add(Dropout(0.2))
model.add(LSTM(100))
model.add(Dropout(0.2))
model.add(Dense(1, activation='sigmoid'))
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
print(model.summary())
model.fit(X_train, y_train, epochs=3, batch_size=64)
# Final evaluation of the model
scores = model.evaluate(X_test, y_test, verbose=0)
print("Accuracy: %.2f%%" % (scores[1]*100))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb96c52f381040208-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c52f381040208-2">2</div><div class="crayon-num" data-line="crayon-5996dbb96c52f381040208-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c52f381040208-4">4</div><div class="crayon-num" data-line="crayon-5996dbb96c52f381040208-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c52f381040208-6">6</div><div class="crayon-num" data-line="crayon-5996dbb96c52f381040208-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c52f381040208-8">8</div><div class="crayon-num" data-line="crayon-5996dbb96c52f381040208-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c52f381040208-10">10</div><div class="crayon-num" data-line="crayon-5996dbb96c52f381040208-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c52f381040208-12">12</div><div class="crayon-num" data-line="crayon-5996dbb96c52f381040208-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c52f381040208-14">14</div><div class="crayon-num" data-line="crayon-5996dbb96c52f381040208-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c52f381040208-16">16</div><div class="crayon-num" data-line="crayon-5996dbb96c52f381040208-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c52f381040208-18">18</div><div class="crayon-num" data-line="crayon-5996dbb96c52f381040208-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c52f381040208-20">20</div><div class="crayon-num" data-line="crayon-5996dbb96c52f381040208-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c52f381040208-22">22</div><div class="crayon-num" data-line="crayon-5996dbb96c52f381040208-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c52f381040208-24">24</div><div class="crayon-num" data-line="crayon-5996dbb96c52f381040208-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c52f381040208-26">26</div><div class="crayon-num" data-line="crayon-5996dbb96c52f381040208-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c52f381040208-28">28</div><div class="crayon-num" data-line="crayon-5996dbb96c52f381040208-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c52f381040208-30">30</div><div class="crayon-num" data-line="crayon-5996dbb96c52f381040208-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c52f381040208-32">32</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb96c52f381040208-1"><span class="crayon-p"># LSTM with Dropout for sequence classification in the IMDB dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c52f381040208-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5996dbb96c52f381040208-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">imdb</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c52f381040208-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5996dbb96c52f381040208-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c52f381040208-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5996dbb96c52f381040208-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dropout</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c52f381040208-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">embeddings </span><span class="crayon-e">import </span><span class="crayon-e">Embedding</span></div><div class="crayon-line" id="crayon-5996dbb96c52f381040208-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-v">sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c52f381040208-10"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line" id="crayon-5996dbb96c52f381040208-11"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c52f381040208-12"><span class="crayon-p"># load the dataset but only keep the top n words, zero the rest</span></div><div class="crayon-line" id="crayon-5996dbb96c52f381040208-13"><span class="crayon-v">top_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c52f381040208-14"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imdb</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-v">num_words</span><span class="crayon-o">=</span><span class="crayon-v">top_words</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c52f381040208-15"><span class="crayon-p"># truncate and pad input sequences</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c52f381040208-16"><span class="crayon-v">max_review_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">500</span></div><div class="crayon-line" id="crayon-5996dbb96c52f381040208-17"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c52f381040208-18"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c52f381040208-19"><span class="crayon-p"># create the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c52f381040208-20"><span class="crayon-v">embedding_vecor_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">32</span></div><div class="crayon-line" id="crayon-5996dbb96c52f381040208-21"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c52f381040208-22"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">top_words</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vecor_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c52f381040208-23"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c52f381040208-24"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c52f381040208-25"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c52f381040208-26"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c52f381040208-27"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c52f381040208-28"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c52f381040208-29"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c52f381040208-30"><span class="crayon-p"># Final evaluation of the model</span></div><div class="crayon-line" id="crayon-5996dbb96c52f381040208-31"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c52f381040208-32"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Accuracy: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
<p>Running this example provides the following output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb96c534281097460" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">Epoch 1/3
16750/16750 [==============================] - 108s - loss: 0.5802 - acc: 0.6898
Epoch 2/3
16750/16750 [==============================] - 108s - loss: 0.4112 - acc: 0.8232
Epoch 3/3
16750/16750 [==============================] - 108s - loss: 0.3825 - acc: 0.8365
Accuracy: 85.56%</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb96c534281097460-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c534281097460-2">2</div><div class="crayon-num" data-line="crayon-5996dbb96c534281097460-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c534281097460-4">4</div><div class="crayon-num" data-line="crayon-5996dbb96c534281097460-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c534281097460-6">6</div><div class="crayon-num" data-line="crayon-5996dbb96c534281097460-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb96c534281097460-1">Epoch 1/3</div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c534281097460-2">16750/16750 [==============================] - 108s - loss: 0.5802 - acc: 0.6898</div><div class="crayon-line" id="crayon-5996dbb96c534281097460-3">Epoch 2/3</div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c534281097460-4">16750/16750 [==============================] - 108s - loss: 0.4112 - acc: 0.8232</div><div class="crayon-line" id="crayon-5996dbb96c534281097460-5">Epoch 3/3</div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c534281097460-6">16750/16750 [==============================] - 108s - loss: 0.3825 - acc: 0.8365</div><div class="crayon-line" id="crayon-5996dbb96c534281097460-7">Accuracy: 85.56%</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can see dropout having the desired impact on training with a 
slightly slower trend in convergence and in this case a lower final 
accuracy. The model could probably use a few more epochs of training and
 may achieve a higher skill (try it an see).</p>
<p>Alternately, dropout can be applied to the input and recurrent 
connections of the memory units with the LSTM precisely and separately.</p>
<p>Keras provides this capability with parameters on the LSTM layer, the <strong>dropout</strong> for configuring the input dropout and <strong>recurrent_dropout</strong>
 for configuring the recurrent dropout. For example, we can modify the 
first example to add dropout to the input and recurrent connections as 
follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb96c539581114901" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">model = Sequential()
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))
model.add(LSTM(100, dropout=0.2, recurrent_dropout=0.2))
model.add(Dense(1, activation='sigmoid'))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb96c539581114901-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c539581114901-2">2</div><div class="crayon-num" data-line="crayon-5996dbb96c539581114901-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c539581114901-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb96c539581114901-1"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c539581114901-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">top_words</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vecor_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c539581114901-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropout</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">recurrent_dropout</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c539581114901-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The full&nbsp;code listing&nbsp;with more precise LSTM dropout is listed below for completeness.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb96c53d168364933" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># LSTM with dropout for sequence classification in the IMDB dataset
import numpy
from keras.datasets import imdb
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from keras.layers.embeddings import Embedding
from keras.preprocessing import sequence
# fix random seed for reproducibility
numpy.random.seed(7)
# load the dataset but only keep the top n words, zero the rest
top_words = 5000
(X_train, y_train), (X_test, y_test) = imdb.load_data(num_words=top_words)
# truncate and pad input sequences
max_review_length = 500
X_train = sequence.pad_sequences(X_train, maxlen=max_review_length)
X_test = sequence.pad_sequences(X_test, maxlen=max_review_length)
# create the model
embedding_vecor_length = 32
model = Sequential()
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))
model.add(LSTM(100, dropout=0.2, recurrent_dropout=0.2))
model.add(Dense(1, activation='sigmoid'))
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
print(model.summary())
model.fit(X_train, y_train, epochs=3, batch_size=64)
# Final evaluation of the model
scores = model.evaluate(X_test, y_test, verbose=0)
print("Accuracy: %.2f%%" % (scores[1]*100))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb96c53d168364933-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c53d168364933-2">2</div><div class="crayon-num" data-line="crayon-5996dbb96c53d168364933-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c53d168364933-4">4</div><div class="crayon-num" data-line="crayon-5996dbb96c53d168364933-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c53d168364933-6">6</div><div class="crayon-num" data-line="crayon-5996dbb96c53d168364933-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c53d168364933-8">8</div><div class="crayon-num" data-line="crayon-5996dbb96c53d168364933-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c53d168364933-10">10</div><div class="crayon-num" data-line="crayon-5996dbb96c53d168364933-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c53d168364933-12">12</div><div class="crayon-num" data-line="crayon-5996dbb96c53d168364933-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c53d168364933-14">14</div><div class="crayon-num" data-line="crayon-5996dbb96c53d168364933-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c53d168364933-16">16</div><div class="crayon-num" data-line="crayon-5996dbb96c53d168364933-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c53d168364933-18">18</div><div class="crayon-num" data-line="crayon-5996dbb96c53d168364933-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c53d168364933-20">20</div><div class="crayon-num" data-line="crayon-5996dbb96c53d168364933-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c53d168364933-22">22</div><div class="crayon-num" data-line="crayon-5996dbb96c53d168364933-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c53d168364933-24">24</div><div class="crayon-num" data-line="crayon-5996dbb96c53d168364933-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c53d168364933-26">26</div><div class="crayon-num" data-line="crayon-5996dbb96c53d168364933-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c53d168364933-28">28</div><div class="crayon-num" data-line="crayon-5996dbb96c53d168364933-29">29</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb96c53d168364933-1"><span class="crayon-p"># LSTM with dropout for sequence classification in the IMDB dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c53d168364933-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5996dbb96c53d168364933-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">imdb</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c53d168364933-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5996dbb96c53d168364933-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c53d168364933-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5996dbb96c53d168364933-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">embeddings </span><span class="crayon-e">import </span><span class="crayon-e">Embedding</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c53d168364933-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-v">sequence</span></div><div class="crayon-line" id="crayon-5996dbb96c53d168364933-9"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c53d168364933-10"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c53d168364933-11"><span class="crayon-p"># load the dataset but only keep the top n words, zero the rest</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c53d168364933-12"><span class="crayon-v">top_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span></div><div class="crayon-line" id="crayon-5996dbb96c53d168364933-13"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imdb</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-v">num_words</span><span class="crayon-o">=</span><span class="crayon-v">top_words</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c53d168364933-14"><span class="crayon-p"># truncate and pad input sequences</span></div><div class="crayon-line" id="crayon-5996dbb96c53d168364933-15"><span class="crayon-v">max_review_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">500</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c53d168364933-16"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c53d168364933-17"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c53d168364933-18"><span class="crayon-p"># create the model</span></div><div class="crayon-line" id="crayon-5996dbb96c53d168364933-19"><span class="crayon-v">embedding_vecor_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">32</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c53d168364933-20"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c53d168364933-21"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">top_words</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vecor_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c53d168364933-22"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropout</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">recurrent_dropout</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c53d168364933-23"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c53d168364933-24"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c53d168364933-25"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c53d168364933-26"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c53d168364933-27"><span class="crayon-p"># Final evaluation of the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c53d168364933-28"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c53d168364933-29"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Accuracy: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
<p>Running this example provides the following output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb96c542423511737" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">Epoch 1/3
16750/16750 [==============================] - 112s - loss: 0.6623 - acc: 0.5935
Epoch 2/3
16750/16750 [==============================] - 113s - loss: 0.5159 - acc: 0.7484
Epoch 3/3
16750/16750 [==============================] - 113s - loss: 0.4502 - acc: 0.7981
Accuracy: 82.82%</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb96c542423511737-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c542423511737-2">2</div><div class="crayon-num" data-line="crayon-5996dbb96c542423511737-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c542423511737-4">4</div><div class="crayon-num" data-line="crayon-5996dbb96c542423511737-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c542423511737-6">6</div><div class="crayon-num" data-line="crayon-5996dbb96c542423511737-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb96c542423511737-1">Epoch 1/3</div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c542423511737-2">16750/16750 [==============================] - 112s - loss: 0.6623 - acc: 0.5935</div><div class="crayon-line" id="crayon-5996dbb96c542423511737-3">Epoch 2/3</div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c542423511737-4">16750/16750 [==============================] - 113s - loss: 0.5159 - acc: 0.7484</div><div class="crayon-line" id="crayon-5996dbb96c542423511737-5">Epoch 3/3</div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c542423511737-6">16750/16750 [==============================] - 113s - loss: 0.4502 - acc: 0.7981</div><div class="crayon-line" id="crayon-5996dbb96c542423511737-7">Accuracy: 82.82%</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can see that the LSTM specific dropout has a more pronounced 
effect on the convergence of the network than the layer-wise dropout. As
 above, the number of epochs was kept constant and could be increased to
 see if the skill of the model can be further lifted.</p>
<p>Dropout is a powerful technique for combating overfitting in your 
LSTM models and it is a good idea to try both methods, but you may bet 
better results with the gate-specific dropout provided in Keras.</p>
<h2>LSTM and Convolutional Neural Network For Sequence Classification</h2>
<p>Convolutional neural networks excel at learning the spatial structure in input data.</p>
<p>The IMDB review data does have a one-dimensional spatial structure in
 the sequence of words in reviews and the CNN may be able to pick out 
invariant features for good and bad sentiment. This learned spatial 
features may then be learned as sequences by an LSTM layer.</p>
<p>We can easily add a one-dimensional CNN and max pooling layers after 
the Embedding layer which then feed the consolidated features to the 
LSTM. We can use a smallish set of 32 features with a small filter 
length of 3. The pooling layer can use the standard length of 2 to halve
 the feature map size.</p>
<p>For example, we would create the model as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb96c547619504674" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">model = Sequential()
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))
model.add(Conv1D(filters=32, kernel_size=3, padding='same', activation='relu'))
model.add(MaxPooling1D(pool_size=2))
model.add(LSTM(100))
model.add(Dense(1, activation='sigmoid'))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb96c547619504674-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c547619504674-2">2</div><div class="crayon-num" data-line="crayon-5996dbb96c547619504674-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c547619504674-4">4</div><div class="crayon-num" data-line="crayon-5996dbb96c547619504674-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c547619504674-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb96c547619504674-1"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c547619504674-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">top_words</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vecor_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c547619504674-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv1D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c547619504674-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling1D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c547619504674-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c547619504674-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>The full&nbsp;code listing&nbsp;with a CNN and LSTM layers is listed below for completeness.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb96c54b426830757" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># LSTM and CNN for sequence classification in the IMDB dataset
import numpy
from keras.datasets import imdb
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from keras.layers.convolutional import Conv1D
from keras.layers.convolutional import MaxPooling1D
from keras.layers.embeddings import Embedding
from keras.preprocessing import sequence
# fix random seed for reproducibility
numpy.random.seed(7)
# load the dataset but only keep the top n words, zero the rest
top_words = 5000
(X_train, y_train), (X_test, y_test) = imdb.load_data(num_words=top_words)
# truncate and pad input sequences
max_review_length = 500
X_train = sequence.pad_sequences(X_train, maxlen=max_review_length)
X_test = sequence.pad_sequences(X_test, maxlen=max_review_length)
# create the model
embedding_vecor_length = 32
model = Sequential()
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))
model.add(Conv1D(filters=32, kernel_size=3, padding='same', activation='relu'))
model.add(MaxPooling1D(pool_size=2))
model.add(LSTM(100))
model.add(Dense(1, activation='sigmoid'))
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
print(model.summary())
model.fit(X_train, y_train, epochs=3, batch_size=64)
# Final evaluation of the model
scores = model.evaluate(X_test, y_test, verbose=0)
print("Accuracy: %.2f%%" % (scores[1]*100))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb96c54b426830757-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c54b426830757-2">2</div><div class="crayon-num" data-line="crayon-5996dbb96c54b426830757-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c54b426830757-4">4</div><div class="crayon-num" data-line="crayon-5996dbb96c54b426830757-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c54b426830757-6">6</div><div class="crayon-num" data-line="crayon-5996dbb96c54b426830757-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c54b426830757-8">8</div><div class="crayon-num" data-line="crayon-5996dbb96c54b426830757-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c54b426830757-10">10</div><div class="crayon-num" data-line="crayon-5996dbb96c54b426830757-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c54b426830757-12">12</div><div class="crayon-num" data-line="crayon-5996dbb96c54b426830757-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c54b426830757-14">14</div><div class="crayon-num" data-line="crayon-5996dbb96c54b426830757-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c54b426830757-16">16</div><div class="crayon-num" data-line="crayon-5996dbb96c54b426830757-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c54b426830757-18">18</div><div class="crayon-num" data-line="crayon-5996dbb96c54b426830757-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c54b426830757-20">20</div><div class="crayon-num" data-line="crayon-5996dbb96c54b426830757-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c54b426830757-22">22</div><div class="crayon-num" data-line="crayon-5996dbb96c54b426830757-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c54b426830757-24">24</div><div class="crayon-num" data-line="crayon-5996dbb96c54b426830757-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c54b426830757-26">26</div><div class="crayon-num" data-line="crayon-5996dbb96c54b426830757-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c54b426830757-28">28</div><div class="crayon-num" data-line="crayon-5996dbb96c54b426830757-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c54b426830757-30">30</div><div class="crayon-num" data-line="crayon-5996dbb96c54b426830757-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c54b426830757-32">32</div><div class="crayon-num" data-line="crayon-5996dbb96c54b426830757-33">33</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb96c54b426830757-1"><span class="crayon-p"># LSTM and CNN for sequence classification in the IMDB dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c54b426830757-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5996dbb96c54b426830757-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">imdb</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c54b426830757-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5996dbb96c54b426830757-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c54b426830757-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5996dbb96c54b426830757-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-e">Conv1D</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c54b426830757-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-e">MaxPooling1D</span></div><div class="crayon-line" id="crayon-5996dbb96c54b426830757-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">embeddings </span><span class="crayon-e">import </span><span class="crayon-e">Embedding</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c54b426830757-10"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-v">sequence</span></div><div class="crayon-line" id="crayon-5996dbb96c54b426830757-11"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c54b426830757-12"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c54b426830757-13"><span class="crayon-p"># load the dataset but only keep the top n words, zero the rest</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c54b426830757-14"><span class="crayon-v">top_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span></div><div class="crayon-line" id="crayon-5996dbb96c54b426830757-15"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imdb</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-v">num_words</span><span class="crayon-o">=</span><span class="crayon-v">top_words</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c54b426830757-16"><span class="crayon-p"># truncate and pad input sequences</span></div><div class="crayon-line" id="crayon-5996dbb96c54b426830757-17"><span class="crayon-v">max_review_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">500</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c54b426830757-18"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c54b426830757-19"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c54b426830757-20"><span class="crayon-p"># create the model</span></div><div class="crayon-line" id="crayon-5996dbb96c54b426830757-21"><span class="crayon-v">embedding_vecor_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">32</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c54b426830757-22"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c54b426830757-23"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">top_words</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vecor_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c54b426830757-24"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv1D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c54b426830757-25"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling1D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c54b426830757-26"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c54b426830757-27"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c54b426830757-28"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c54b426830757-29"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c54b426830757-30"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c54b426830757-31"><span class="crayon-p"># Final evaluation of the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c54b426830757-32"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb96c54b426830757-33"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Accuracy: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0021 seconds] -->
<p>Running this example provides the following output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb96c551965951684" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">Epoch 1/3
16750/16750 [==============================] - 58s - loss: 0.5186 - acc: 0.7263
Epoch 2/3
16750/16750 [==============================] - 58s - loss: 0.2946 - acc: 0.8825
Epoch 3/3
16750/16750 [==============================] - 58s - loss: 0.2291 - acc: 0.9126
Accuracy: 86.36%</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb96c551965951684-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c551965951684-2">2</div><div class="crayon-num" data-line="crayon-5996dbb96c551965951684-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c551965951684-4">4</div><div class="crayon-num" data-line="crayon-5996dbb96c551965951684-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb96c551965951684-6">6</div><div class="crayon-num" data-line="crayon-5996dbb96c551965951684-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb96c551965951684-1">Epoch 1/3</div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c551965951684-2">16750/16750 [==============================] - 58s - loss: 0.5186 - acc: 0.7263</div><div class="crayon-line" id="crayon-5996dbb96c551965951684-3">Epoch 2/3</div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c551965951684-4">16750/16750 [==============================] - 58s - loss: 0.2946 - acc: 0.8825</div><div class="crayon-line" id="crayon-5996dbb96c551965951684-5">Epoch 3/3</div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb96c551965951684-6">16750/16750 [==============================] - 58s - loss: 0.2291 - acc: 0.9126</div><div class="crayon-line" id="crayon-5996dbb96c551965951684-7">Accuracy: 86.36%</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can see that we achieve similar results to the first example although with less weights and faster training time.</p>
<p>I would expect that even better results could be achieved if this example was further extended to use dropout.</p>
<h2>Resources</h2>
<p>Below are some resources if you are interested in diving deeper into sequence prediction or this specific example.</p>
<ul>
<li><a href="http://deeplearning.net/tutorial/lstm.html">Theano tutorial for LSTMs applied to the IMDB dataset</a></li>
<li>Keras code example for using an <a href="https://github.com/fchollet/keras/blob/master/examples/imdb_lstm.py">LSTM and CNN</a> with <a href="https://github.com/fchollet/keras/blob/master/examples/imdb_cnn_lstm.py">LSTM on the IMDB dataset</a>.</li>
<li><a class="easyazon-link" href="http://www.amazon.com/dp/3642247962?tag=inspiredalgor-20">Supervised Sequence Labelling with Recurrent Neural Networks</a>, 2012 book by Alex Graves (<a href="https://www.cs.toronto.edu/%7Egraves/preprint.pdf">and PDF preprint</a>).</li>
</ul>
<h2>Summary</h2>
<p>In this post you discovered how to develop LSTM network models for sequence classification predictive modeling problems.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to develop a simple single layer LSTM model for the IMDB movie review sentiment classification problem.</li>
<li>How to extend your LSTM model with layer-wise and LSTM-specific dropout to reduce overfitting.</li>
<li>How to combine the spatial structure learning properties of a 
Convolutional Neural Network with the sequence learning of an LSTM.</li>
</ul>
<p>Do you have any questions about sequence classification with LSTMs or
 about this post? Ask your questions in the comments and I will do my 
best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-30">			<div class="textwidget"><p></p><div class="woo-sc-hr"></div><p></p>
<p></p><center><p></p>
<h2>Develop LSTMs for Sequence Prediction Today!</h2>
<p><a href="http://machinelearningmastery.com/lstms-with-python/"><img style="border: 0;" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/Cover-220.png" alt="Long Short-Term Memory Networks with Python" align="left"></a></p>
<h4>Develop Your Own LSTM models in Minutes</h4>
<p>…with just a few lines of python code</p>
<p>Discover how in my new Ebook:<br>
<a href="http://machinelearningmastery.com/lstms-with-python/">Long Short-Term Memory Networks with Python</a></p>
<p>It provides <strong>self-study tutorials</strong> on topics like:<br>
<em>CNN LSTMs, Encoder-Decoder LSTMs, generative models, data preparation, making predictions</em> and much more…</p>
<h4>Finally Bring LSTM Recurrent Neural Networks to<br>
Your Sequence Predictions Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="http://machinelearningmastery.com/lstms-with-python/">Click to learn more</a>.<br>
</p></center><br>
<div class="woo-sc-hr"></div><p></p>
</div>
		</div></div><div class="apss-social-share apss-theme-4 clearfix">


				<div class="apss-twitter apss-single-icon">
					<a rel="nofollow" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras&amp;url=http%3A%2F%2Fmachinelearningmastery.com%2Fsequence-classification-lstm-recurrent-neural-networks-python-keras%2F&amp;');" href="javascript:void(0);" title="Share on Twitter" target="">
						<div class="apss-icon-block clearfix">
							<i class="fa fa-twitter"></i>
							<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
						</div>
											</a>
				</div>
								<div class="apss-facebook apss-single-icon">
					<a rel="nofollow" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/');" title="Share on Facebook" target="" href="https://www.facebook.com/sharer/sharer.php?u=http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/">
						<div class="apss-icon-block clearfix">
							<i class="fa fa-facebook"></i>
							<span class="apss-social-text">Share on Facebook</span>
							<span class="apss-share">Share</span>
						</div>
											</a>
				</div>
				
				<div class="apss-linkedin apss-single-icon">
					<a rel="nofollow" onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras&amp;url=http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/&amp;summary=Sequence+classification+is+a+predictive+modeling+problem+where+you+have+some+sequence+of+inputs+over...');" title="Share on LinkedIn" target="" href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras&amp;url=http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/&amp;summary=Sequence+classification+is+a+predictive+modeling+problem+where+you+have+some+sequence+of+inputs+over...">
						<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
							<span class="apss-social-text">Share on LinkedIn</span>
							<span class="apss-share">Share</span>
						</div>
											</a>
				</div>
								<div class="apss-google-plus apss-single-icon">
					<a rel="nofollow" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/');" title="Share on Google Plus" target="" href="https://plus.google.com/share?url=http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/">
						<div class="apss-icon-block clearfix">
							<i class="fa fa-google-plus"></i>
							<span class="apss-social-text">Share on Google Plus</span>
							<span class="apss-share">Share</span>
						</div>
											</a>
				</div>
				</div>	</section><!-- /.entry -->
	<div class="fix"></div>
<aside id="post-author">
	<div class="profile-image"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37_003.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" class="avatar avatar-80 photo" height="80" width="80"></div>
	<div class="profile-content">
		<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, 
author, professional developer and a machine learning practitioner. He 
is dedicated to helping developers get started and get good at applied 
machine learning.
<a href="http://machinelearningmastery.com/about">Learn more</a>.				<div class="profile-link">
			<a href="http://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span>			</a>
		</div><!--#profile-link-->
			</div>
	<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="http://machinelearningmastery.com/use-classification-machine-learning-algorithms-weka/" rel="prev"><i class="fa fa-angle-left"></i> How To Use Classification Machine Learning Algorithms in Weka</a></div>
	            <div class="nav-next fr"><a href="http://machinelearningmastery.com/use-ensemble-machine-learning-algorithms-weka/" rel="next">How to Use Ensemble Machine Learning Algorithms in Weka <i class="fa fa-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">227 Responses to <em>Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</em></h3>
		 	<ol class="commentlist">
				
		<li id="comment-358300" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-358300" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/c451248e578fd6a3ffffed35589cd285.jpeg" srcset="http://0.gravatar.com/avatar/c451248e578fd6a3ffffed35589cd285?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Atlant</span>
	                <span class="date">July 29, 2016 at 7:15 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-358300" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It’s geat!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=358300#respond" onclick='return addComment.moveForm( "comment-358300", "358300", "respond", "2938" )' aria-label="Reply to Atlant">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-360044" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-360044" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 15, 2016 at 12:30 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-360044" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Atlant.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=360044#respond" onclick='return addComment.moveForm( "comment-360044", "360044", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-358383" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-358383" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/19a9144d7660313bc88120f5a2453479.jpeg" srcset="http://1.gravatar.com/avatar/19a9144d7660313bc88120f5a2453479?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sahil</span>
	                <span class="date">July 30, 2016 at 9:34 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-358383" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason,</p>
<p>Congrats brother, for continuous great and easy to 
adapt/understanding lessons. I am just curious to know unsupervised and 
reinforced neural nets, any tutorials you have?</p>
<p>Regards,<br>
Sahil</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=358383#respond" onclick='return addComment.moveForm( "comment-358383", "358383", "respond", "2938" )' aria-label="Reply to Sahil">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-358415" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-358415" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 31, 2016 at 7:09 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-358415" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Sahil.</p>
<p>Sorry, no tutorials on unsupervised learning or reinforcement learning with neural nets just yet. Soon though.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=358415#respond" onclick='return addComment.moveForm( "comment-358415", "358415", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-358457" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-358457" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/ffa50b2ca24453993f3a1aaefc6db603.jpeg" srcset="http://0.gravatar.com/avatar/ffa50b2ca24453993f3a1aaefc6db603?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Søren Pallesen</span>
	                <span class="date">August 1, 2016 at 1:43 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-358457" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, great stuff you are publishing here thanks.</p>
<p>Would this network architecture work for predicting profitability of a stock based time series data of the stock price.</p>
<p>For example with data samples of daily stock prices and trading 
volumes with 5 minute intervals from 9.30am to 1pm paired with YES or NO
 to the stockprice increasing by more than 0.5% the rest of the trading 
day?</p>
<p>Each trading day is one sample and th3 entire data set woule for example the last 1000 trading days.</p>
<p>If this network architecture is not suitable what other would you suggest testing our?</p>
<p>Again thanks for this super resdource.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=358457#respond" onclick='return addComment.moveForm( "comment-358457", "358457", "respond", "2938" )' aria-label="Reply to Søren Pallesen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-358467" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-358467" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 1, 2016 at 6:24 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-358467" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Søren.</p>
<p>Sure, it would be worth trying, but I am not an expert on the stock market.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=358467#respond" onclick='return addComment.moveForm( "comment-358467", "358467", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-359730" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-359730" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/7e9703ec9f4e1abae82171831b6c18fc.png" srcset="http://1.gravatar.com/avatar/7e9703ec9f4e1abae82171831b6c18fc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Naufal</span>
	                <span class="date">August 12, 2016 at 2:50 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-359730" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>So, the end result of this tutorial is a model. Could you give me
 an example how to use this model to predict a new review, especially 
using new vocabularies that don’t present in training data? Many 
thanks..</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=359730#respond" onclick='return addComment.moveForm( "comment-359730", "359730", "respond", "2938" )' aria-label="Reply to Naufal">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-360046" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-360046" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 15, 2016 at 12:31 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-360046" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t have an example Naufal, but the new example would have to
 encode words using the same integers and embed the integers into the 
same word mapping.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=360046#respond" onclick='return addComment.moveForm( "comment-360046", "360046", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-392501" class="comment even depth-3 parent">

	      	<div id="li-comment-392501" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/0f3e51a33d58b7e2af3eb177ec697d10.jpeg" srcset="http://0.gravatar.com/avatar/0f3e51a33d58b7e2af3eb177ec697d10?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Faraaz Mohammed</span>
	                <span class="date">March 13, 2017 at 7:21 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-392501" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason for excellent article.<br>
to predict i did below things, please correct i am did wrong. you said to embed..i didnt get that. how to do that.</p>
<p>text = numpy.array([‘this is excellent sentence’])<br>
#print(text.shape)<br>
tk = keras.preprocessing.text.Tokenizer( nb_words=2000, lower=True,split=” “)<br>
tk.fit_on_texts(text)<br>
prediction = model.predict(numpy.array(tk.texts_to_sequences(text)))<br>
print(prediction)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=392501#respond" onclick='return addComment.moveForm( "comment-392501", "392501", "respond", "2938" )' aria-label="Reply to Faraaz Mohammed">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-392515" class="comment odd alt depth-4">

	      	<div id="li-comment-392515" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/0f3e51a33d58b7e2af3eb177ec697d10.jpeg" srcset="http://0.gravatar.com/avatar/0f3e51a33d58b7e2af3eb177ec697d10?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Faraaz Mohammed</span>
	                <span class="date">March 13, 2017 at 9:43 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-392515" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason for excellent article.<br>
to predict i did below things, please correct i am did wrong. you said to embed..i didnt get that. how to do that.</p>
<p>text = numpy.array([‘this is excellent sentence’])<br>
#print(text.shape)<br>
tk = keras.preprocessing.text.Tokenizer( nb_words=2000, lower=True,split=” “)<br>
tk.fit_on_texts(text)<br>
prediction = model.predict(sequence.pad_sequences(tk.texts_to_sequences(text),maxlen=max_review_length))<br>
print(prediction)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=392515#respond" onclick='return addComment.moveForm( "comment-392515", "392515", "respond", "2938" )' aria-label="Reply to Faraaz Mohammed">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-392577" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-392577" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 14, 2017 at 8:14 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-392577" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Embed refers to the word embedding layer:<br>
<a href="https://keras.io/layers/embeddings/" rel="nofollow">https://keras.io/layers/embeddings/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=392577#respond" onclick='return addComment.moveForm( "comment-392577", "392577", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-361342" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-361342" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/cf774b0d316833ed45c5cc1463ee7634.jpeg" srcset="http://0.gravatar.com/avatar/cf774b0d316833ed45c5cc1463ee7634?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Joey</span>
	                <span class="date">August 24, 2016 at 6:45 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-361342" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason! Great tutorials!</p>
<p>When I attempt this tutorial, I get the error message from imdb.load_data :</p>
<p>    TypeError: load_data() got an unexpected keyword argument ‘test_split’ </p>
<p>I tried copying and pasting the entire source code but this line still had the same error.</p>
<p>Can you think of any underlying reason that this is not executing for me?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=361342#respond" onclick='return addComment.moveForm( "comment-361342", "361342", "respond", "2938" )' aria-label="Reply to Joey">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-361359" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-361359" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 24, 2016 at 8:33 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-361359" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that Joey. It looks like a change with Keras v1.0.7. </p>
<p>I get the same error if I run with version 1.0.7. I can see the API doco still refers to the test_split argument here: <a href="https://keras.io/datasets/#imdb-movie-reviews-sentiment-classification" rel="nofollow">https://keras.io/datasets/#imdb-movie-reviews-sentiment-classification</a></p>
<p>I can see that the argument was removed from the function here:<br>
<a href="https://github.com/fchollet/keras/blob/master/keras/datasets/imdb.py" rel="nofollow">https://github.com/fchollet/keras/blob/master/keras/datasets/imdb.py</a></p>
<p>Option 1) You can remove the argument from the function to use the default test 50/50 split.</p>
<p>Option 2) You can downgrade Keras to version 1.0.6:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb974295541436319" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">sudo pip install --upgrade --no-deps keras==1.0.6</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb974295541436319-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb974295541436319-1"><span class="crayon-e">sudo </span><span class="crayon-e">pip </span><span class="crayon-v">install</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-v">upgrade</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-v">no</span><span class="crayon-o">-</span><span class="crayon-e">deps </span><span class="crayon-v">keras</span><span class="crayon-o">==</span><span class="crayon-cn">1.0.6</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>Remember you can check your Keras version on the command line with:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb97429f693938810" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">python -c "import keras; print keras.__version__"</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb97429f693938810-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb97429f693938810-1"><span class="crayon-v">python</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-s">"import keras; print keras.__version__"</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<p>I will look at updating the example to be compatible with the latest Keras.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=361359#respond" onclick='return addComment.moveForm( "comment-361359", "361359", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-361493" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-361493" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/cf774b0d316833ed45c5cc1463ee7634.jpeg" srcset="http://0.gravatar.com/avatar/cf774b0d316833ed45c5cc1463ee7634?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Joey</span>
	                <span class="date">August 25, 2016 at 4:27 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-361493" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I got it working! Thanks so much for all of the help Jason!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=361493#respond" onclick='return addComment.moveForm( "comment-361493", "361493", "respond", "2938" )' aria-label="Reply to Joey">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-361502" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-361502" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 25, 2016 at 5:07 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-361502" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear it Joey.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=361502#respond" onclick='return addComment.moveForm( "comment-361502", "361502", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-366529" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-366529" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 7, 2016 at 2:22 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-366529" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have updated the examples in the post to match Keras 1.1.0 and TensorFlow 0.10.0.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-362405" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-362405" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/2aa424179ff953a75e6b5a77c10c2488.png" srcset="http://2.gravatar.com/avatar/2aa424179ff953a75e6b5a77c10c2488?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chong Wang</span>
	                <span class="date">August 29, 2016 at 11:13 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-362405" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason.</p>
<p>A quick question:<br>
Based on my understanding, padding zero in front is like labeling 
‘START’. Otherwise it is like labeling ‘END’. How should I decide ‘pre’ 
padding or ‘post’ padding? Does it matter?</p>
<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=362405#respond" onclick='return addComment.moveForm( "comment-362405", "362405", "respond", "2938" )' aria-label="Reply to Chong Wang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-362628" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-362628" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 30, 2016 at 8:24 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-362628" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t think I understand the question, sorry Chong. </p>
<p>Consider trying both padding approaches on your problem and see what works best.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=362628#respond" onclick='return addComment.moveForm( "comment-362628", "362628", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-366383" class="comment even depth-3 parent">

	      	<div id="li-comment-366383" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/2aa424179ff953a75e6b5a77c10c2488.png" srcset="http://2.gravatar.com/avatar/2aa424179ff953a75e6b5a77c10c2488?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chong Wang</span>
	                <span class="date">October 6, 2016 at 7:49 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-366383" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason.</p>
<p>Thanks for your reply.</p>
<p>I have another quick question in section “LSTM For Sequence Classification With Dropout”.</p>
<p>model.add(Embedding(top_words, embedding_vector_length, input_length=max_review_length, dropout=0.2))<br>
model.add(Dropout(0.2))<br>
…</p>
<p>Here I see two dropout layers. The second one is easy to understand: 
For each time step, It just randomly deactivates 20% numbers in the 
output embedding vector. </p>
<p>The first one confuses me: Does it do dropout on the input? For each 
time step, the input of the embedding layers should be only one index of
 the top words. In other words, the input is one single number. How can 
we dropout it?  (Or do you mean drop the input indices of 20% time 
steps?)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=366383#respond" onclick='return addComment.moveForm( "comment-366383", "366383", "respond", "2938" )' aria-label="Reply to Chong Wang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-366402" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-366402" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 6, 2016 at 9:50 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-366402" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question, I believe it drops out weights from the input nodes from the embedded layer to the hidden layer.</p>
<p>You can learn more about dropout here:<br>
<a href="http://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/" rel="nofollow">http://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=366402#respond" onclick='return addComment.moveForm( "comment-366402", "366402", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-381667" class="comment even depth-5">

	      	<div id="li-comment-381667" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/6a06e15b5e3c4f3a91169045d6c4ad94.jpeg" srcset="http://0.gravatar.com/avatar/6a06e15b5e3c4f3a91169045d6c4ad94?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kuow</span>
	                <span class="date">January 12, 2017 at 4:10 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381667" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can the dropout applied in the Embedding layer be thought of as 
randomly removing a word in a sentence and forcing the classification 
not to rely on any word?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-381803" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-381803" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 13, 2017 at 9:09 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381803" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t see why not – off the cuff.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-362750" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-362750" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/535b6620ff85df40d458b89023cba26b.jpeg" srcset="http://2.gravatar.com/avatar/535b6620ff85df40d458b89023cba26b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harish</span>
	                <span class="date">August 30, 2016 at 8:10 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-362750" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>Thanks for providing such easy explanations for these complex topics.</p>
<p>In this tutorial, Embedding layer is used as the input layer as the data is a sequence of words.</p>
<p>I am working on a problem where I have a sequence of images  as an 
example and a particular label is assigned to each example. The number 
of images in the sequence will vary from example to example. I have the 
following questions:<br>
1)  Can I use a LSTM layer as an input layer?</p>
<p>2) If the input layer is a LSTM layer, is there still a need to 
specify the max_len (which is constraint mentioning the maximum number 
of images an example can have)</p>
<p>Thanks in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=362750#respond" onclick='return addComment.moveForm( "comment-362750", "362750", "respond", "2938" )' aria-label="Reply to Harish">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-362849" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-362849" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 31, 2016 at 9:28 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-362849" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Interesting problem Harish.</p>
<p>I would caution you to consider a suite of different ways of representing this problem, then try a few to see what works.</p>
<p>My gut suggests using CNNs on the front end for the image data and 
then an LSTM in the middle and some dense layers on the backend for 
transforming the representation into a prediction. </p>
<p>I hope that helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=362849#respond" onclick='return addComment.moveForm( "comment-362849", "362849", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-362894" class="comment even depth-3 parent">

	      	<div id="li-comment-362894" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/535b6620ff85df40d458b89023cba26b.jpeg" srcset="http://2.gravatar.com/avatar/535b6620ff85df40d458b89023cba26b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harish</span>
	                <span class="date">August 31, 2016 at 3:31 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-362894" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks you very much Jason.</p>
<p>Can you please let me know how to deal with sequences of different 
length without padding in this problem. If padding is required, how to 
choose the max. length for padding the sequence of images.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=362894#respond" onclick='return addComment.moveForm( "comment-362894", "362894", "respond", "2938" )' aria-label="Reply to Harish">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-363018" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-363018" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 1, 2016 at 7:56 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-363018" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Padding is required for sequences of variable length.</p>
<p>Choose a max length based on all the data you have available to evaluate.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=363018#respond" onclick='return addComment.moveForm( "comment-363018", "363018", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-363112" class="comment even depth-5">

	      	<div id="li-comment-363112" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/535b6620ff85df40d458b89023cba26b.jpeg" srcset="http://2.gravatar.com/avatar/535b6620ff85df40d458b89023cba26b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harish</span>
	                <span class="date">September 1, 2016 at 5:12 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-363112" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your time and suggestion Jason.</p>
<p>Can you please explain what masking the input layer means and how can it be used to handle padding in keras.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-363682" class="comment odd alt depth-2">

	      	<div id="li-comment-363682" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/cde15d1d86cabfbff6bf06fc5ec2ebd4.jpeg" srcset="http://0.gravatar.com/avatar/cde15d1d86cabfbff6bf06fc5ec2ebd4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sreekar Reddy</span>
	                <span class="date">September 5, 2016 at 10:37 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-363682" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Harish,<br>
I am working on a similar problem and would like to know if you continued on this problem? What worked and what did not?</p>
<p>Thanks in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=363682#respond" onclick='return addComment.moveForm( "comment-363682", "363682", "respond", "2938" )' aria-label="Reply to Sreekar Reddy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-363002" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-363002" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/b1cb6c154fabe47331018f0c1dfe98e2.jpeg" srcset="http://2.gravatar.com/avatar/b1cb6c154fabe47331018f0c1dfe98e2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gciniwe</span>
	                <span class="date">September 1, 2016 at 6:26 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-363002" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for this tutorial. It’s so helpful! I would like to adapt this
 to my own problem. I’m working on a problem where I have a sequence of 
acoustic samples. The sequences vary in length, and I know the identity 
of the individual/entity producing the signal in each sequence. Since 
these sequences have a temporal element to them, (each sequence is a 
series in time and sequences belonging to the same individual are also 
linked temporally), I thought LSTM would be the way to go.<br>
According to my understanding, the Embedding layer in this tutorial 
works to add an extra dimension to the dataset since the LSTM layer 
takes in 3D input data.</p>
<p>My question is is it advisable to use LSTM layer as a first layer in 
my problem, seeing that Embedding wouldn’t work with my non-integer 
acoustic samples? I know that in order to use LSTM as my first layer, I 
have to somehow reshape my data in a meaningful way so that it meets the
 requirements of the inputs of LSTM layer. I’ve already padded my 
sequences so my dataset is currently a 2D tensor. Padding with zeros 
however was not ideal because some of the original acoustic sample 
values are zero, representing a zero-pressure level. So I’ve manually 
padded using a different number. </p>
<p>I’m planning to use a stack of LSTM layers and a Dense layer at the end of my Sequential model. </p>
<p>P.s. I’m new to Keras. I’d appreciate any advice you can give.</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=363002#respond" onclick='return addComment.moveForm( "comment-363002", "363002", "respond", "2938" )' aria-label="Reply to Gciniwe">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-363021" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-363021" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 1, 2016 at 8:03 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-363021" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad it was useful Gciniwe.</p>
<p>Great question and hard to answer. I would caution you to review some
 literature for audio-based applications of LSTMs and CNNs and see what 
representations were used. The examples I’ve seen have been (sadly) 
trivial.</p>
<p>Try LSTM as the first layer, but also experiment with CNN (1D) then 
LSTM for additional opportunities to pull out structure. Perhaps also 
try Dense then LSTM. I would use one or more Dense on the output layers.</p>
<p>Good luck, I’m very interested to hear what you come up with.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=363021#respond" onclick='return addComment.moveForm( "comment-363021", "363021", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-363096" class="comment even depth-2">

	      	<div id="li-comment-363096" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/535b6620ff85df40d458b89023cba26b.jpeg" srcset="http://2.gravatar.com/avatar/535b6620ff85df40d458b89023cba26b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harish</span>
	                <span class="date">September 1, 2016 at 4:07 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-363096" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Gciniwe</p>
<p>Its interesting to see that I am also working on a similar problem. I
 work on speech and image processing. I have a small doubt. Please may I
 know how did you choose the padding values. Because in images also, we 
will have zeros and unable to understand how to do padding. </p>
<p>Thanks in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=363096#respond" onclick='return addComment.moveForm( "comment-363096", "363096", "respond", "2938" )' aria-label="Reply to Harish">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-364992" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-364992" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/f1c6da7afe795d6f26e9eaeba6f5a0dd.jpeg" srcset="http://0.gravatar.com/avatar/f1c6da7afe795d6f26e9eaeba6f5a0dd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">nick</span>
	                <span class="date">September 20, 2016 at 2:16 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-364992" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>When i run the above code , i am getting the following error<br>
:MemoryError: alloc failed<br>
Apply node that caused the error: Alloc(TensorConstant{(1L, 1L, 1L) of 
0.0}, TensorConstant{24}, Elemwise{Composite{((i0 * i1) // i2)}}[(0, 
0)].0, TensorConstant{280})<br>
Toposort index: 145<br>
Inputs types: [TensorType(float32, (True, True, True)), 
TensorType(int64, scalar), TensorType(int64, scalar), TensorType(int64, 
scalar)]<br>
Inputs shapes: [(1L, 1L, 1L), (), (), ()]<br>
Inputs strides: [(4L, 4L, 4L), (), (), ()]<br>
Inputs values: [array([[[ 0.]]], dtype=float32), array(24L, dtype=int64), array(-450L, dtype=int64), array(280L, dtype=int64)]<br>
Outputs clients: [[IncSubtensor{Inc;:int64:}(Alloc.0, 
Subtensor{::int64}.0, Constant{24}), 
IncSubtensor{InplaceInc;int64::}(Alloc.0, IncSubtensor{Inc;:int64:}.0, 
Constant{0}), forall_inplace,cpu,grad_of_scan_fn}(TensorConstant{24}, 
Elemwise{tanh}.0, Subtensor{int64:int64:int64}.0, Alloc.0, 
Elemwise{Composite{(i0 – sqr(i1))}}.0, Subtensor{int64:int64:int64}.0, 
Subtensor{int64:int64:int64}.0,<br>
any idea why? i am using theano 0.8.2 and keras 1.0.8</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=364992#respond" onclick='return addComment.moveForm( "comment-364992", "364992", "respond", "2938" )' aria-label="Reply to nick">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-365033" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-365033" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 20, 2016 at 8:34 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-365033" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m sorry to hear that Nick, I’ve not seen this error.</p>
<p>Perhaps try the Theano backend and see if that makes any difference?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=365033#respond" onclick='return addComment.moveForm( "comment-365033", "365033", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370129" class="comment odd alt depth-3">

	      	<div id="li-comment-370129" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/d4a4b346ea44c6cb3c40bc8b6a466759.jpeg" srcset="http://1.gravatar.com/avatar/d4a4b346ea44c6cb3c40bc8b6a466759?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shristi Baral</span>
	                <span class="date">November 9, 2016 at 9:57 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370129" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I got the same problem and I have no clue how to solve it..</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=370129#respond" onclick='return addComment.moveForm( "comment-370129", "370129", "respond", "2938" )' aria-label="Reply to Shristi Baral">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-366110" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-366110" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/3f8d88b95adea11e00797b7d6ff6459e.jpeg" srcset="http://0.gravatar.com/avatar/3f8d88b95adea11e00797b7d6ff6459e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Deepak</span>
	                <span class="date">October 3, 2016 at 2:41 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-366110" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I have one question. Can I use RNN LSTM for Time Series Sales 
Analysis. I have only one input every day sales of last one year. so 
total data points is around 278 and I want to predict for next 6 months.
 Will this much data points is sufficient for using RNN techniques.. and
 also can you please explain what is difference between LSTM and GRU and
 where to USE LSTM or GRU</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=366110#respond" onclick='return addComment.moveForm( "comment-366110", "366110", "respond", "2938" )' aria-label="Reply to Deepak">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-366120" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-366120" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 3, 2016 at 5:21 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-366120" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Deepak, My advice would be to try LSTM on your problem and see. </p>
<p>You may be better served using simpler statistical methods to forecast 60 months of sales data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=366120#respond" onclick='return addComment.moveForm( "comment-366120", "366120", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-367068" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-367068" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/01b09081999159e0bbfc52b207af8dcd.jpeg" srcset="http://0.gravatar.com/avatar/01b09081999159e0bbfc52b207af8dcd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Corne Prinsloo</span>
	                <span class="date">October 13, 2016 at 5:59 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-367068" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, this is great. Thanks!  </p>
<p>I would also love to see some unsupervised learning to know how it works and what the applications are.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=367068#respond" onclick='return addComment.moveForm( "comment-367068", "367068", "respond", "2938" )' aria-label="Reply to Corne Prinsloo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-367113" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-367113" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 14, 2016 at 8:59 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-367113" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Corne,</p>
<p>I tend not to write tutorials on unsupervised techniques (other than 
feature selection) as I do not find methods like clustering useful in 
practice on predictive modeling problems.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=367113#respond" onclick='return addComment.moveForm( "comment-367113", "367113", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-367097" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-367097" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/621772e26db2c5756b425fc5a55c5670.jpeg" srcset="http://0.gravatar.com/avatar/621772e26db2c5756b425fc5a55c5670?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://none/" rel="external nofollow" class="url">Jeff Wu</a></span>
	                <span class="date">October 14, 2016 at 5:49 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-367097" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for writing this tutorial.  It’s very helpful. Why do LSTMs not require normalization of their features’ values?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=367097#respond" onclick='return addComment.moveForm( "comment-367097", "367097", "respond", "2938" )' aria-label="Reply to Jeff Wu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-367118" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-367118" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 14, 2016 at 9:09 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-367118" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jeff, great question.</p>
<p>Often you can get better performance with neural networks when the 
data is scaled to the range of the transfer function. In this case we 
use a sigmoid within the LSTMs so we find we get better performance by 
normalizing input data to the range 0-1.</p>
<p>I hope that helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=367118#respond" onclick='return addComment.moveForm( "comment-367118", "367118", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405070" class="comment even depth-3 parent">

	      	<div id="li-comment-405070" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1fb261732f0bcb1a475cf3ad4dcf5251.jpeg" srcset="http://1.gravatar.com/avatar/1fb261732f0bcb1a475cf3ad4dcf5251?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yuri</span>
	                <span class="date">July 8, 2017 at 5:37 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405070" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thanks for a great tutorial!</p>
<p>I am trying to normalize the data, basically dividing each element in
 X by the largest value (in this case 5000), since X is in range [0, 
5000]. And I get much worse performance. Any idea why? Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=405070#respond" onclick='return addComment.moveForm( "comment-405070", "405070", "respond", "2938" )' aria-label="Reply to Yuri">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405256" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-405256" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 9, 2017 at 10:49 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405256" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No. Try other scaling methods.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=405256#respond" onclick='return addComment.moveForm( "comment-405256", "405256", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-367513" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-367513" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/982fe9edec4382849efdc3cca9679a7a.jpeg" srcset="http://0.gravatar.com/avatar/982fe9edec4382849efdc3cca9679a7a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lau MingFei</span>
	                <span class="date">October 19, 2016 at 10:21 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-367513" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason! Your tutorial is very helpful. But I still have a 
question about using dropouts in the LSTM cells. What is the difference 
of the actual effects of droupout_W and dropout_U? Should I just set 
them the same value in most cases? Could you recommend any paper related
 to this topic? Thank you very much!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=367513#respond" onclick='return addComment.moveForm( "comment-367513", "367513", "respond", "2938" )' aria-label="Reply to Lau MingFei">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-367556" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-367556" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 20, 2016 at 8:38 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-367556" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would refer you to the API Lau:<br>
<a href="https://keras.io/layers/recurrent/#lstm" rel="nofollow">https://keras.io/layers/recurrent/#lstm</a></p>
<blockquote><p>
dropout_W: float between 0 and 1. Fraction of the input units to drop for input gates.<br>
dropout_U: float between 0 and 1. Fraction of the input units to drop for recurrent connections.
</p></blockquote>
<p>Generally, I recommend testing different values and see what works. 
In practice setting them to the same values might be a good starting 
point.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=367556#respond" onclick='return addComment.moveForm( "comment-367556", "367556", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-368078" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-368078" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/cf630658f07dfb0e6981a9b4ea1bc240.jpeg" srcset="http://0.gravatar.com/avatar/cf630658f07dfb0e6981a9b4ea1bc240?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jeff</span>
	                <span class="date">October 24, 2016 at 10:16 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-368078" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,<br>
thanks for the nice article. I have a question about the data encoding: 
“The words have been replaced by integers that indicate the ordered 
frequency of each word in the dataset”.</p>
<p>What exactly does ordered frequency mean? For instance, is the most frequent word encoded as 0 or 4999 in the end?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=368078#respond" onclick='return addComment.moveForm( "comment-368078", "368078", "respond", "2938" )' aria-label="Reply to Jeff">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-368136" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-368136" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 25, 2016 at 8:23 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-368136" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question Jeff.</p>
<p>I believe the most frequent word is 1.</p>
<p>I believe 0 was left for use as padding or when we want to trip low frequency words.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=368136#respond" onclick='return addComment.moveForm( "comment-368136", "368136", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-368087" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-368087" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/5fcf52929ef5f44e868b3a8339673b8e.jpeg" srcset="http://2.gravatar.com/avatar/5fcf52929ef5f44e868b3a8339673b8e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mazen</span>
	                <span class="date">October 25, 2016 at 12:27 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-368087" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your very useful posts.<br>
I have a question.<br>
In the last example (CNN&amp;LSTM), It’s clear that we gained a faster 
training time, but how can we know that CNN is suitable here for this 
problem as a prior layer to LSTM. What does the spatial structure here 
mean? So, If I understand how to decide whether a dataset X has a 
spatial structure, then will this be a suitable clue to suggest a prior 
CNN to LSTM layer in a sequence-based problem?</p>
<p>Thanks,<br>
Mazen</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=368087#respond" onclick='return addComment.moveForm( "comment-368087", "368087", "respond", "2938" )' aria-label="Reply to Mazen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-368141" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-368141" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 25, 2016 at 8:28 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-368141" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Mazen, </p>
<p>The spatial structure is the order of words. To the CNN, they are 
just a sequence of numbers, but we know that that sequence has structure
 – the words (numbers used to represent words) and their order matter.</p>
<p>Model selection is hard. Often you want to pick the model that has 
the mix of the best performance and lowest complexity (easy to 
understand, maintain, retrain, use in production).</p>
<p>Yes, if a problem has some spatial structure (image, text, etc.) try a method that preserves that structure, like a CNN.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=368141#respond" onclick='return addComment.moveForm( "comment-368141", "368141", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-369832" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-369832" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/6a7dc21d6e59d7d548db2fee85029c41.jpeg" srcset="http://0.gravatar.com/avatar/6a7dc21d6e59d7d548db2fee85029c41?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eduardo</span>
	                <span class="date">November 8, 2016 at 3:31 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-369832" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, great post!</p>
<p>I have been trying to use your experiment to classify text that come 
from several blogs for gender classification. However, I am getting a 
low accuracy close to 50%. Do you have any suggestions in terms of how I
 could pre-process my data to fit in the model? Each blog text has 
approximately 6000 words and i am doing some research know to see what I
 can do in terms of pre-processing to apply to your model.</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=369832#respond" onclick='return addComment.moveForm( "comment-369832", "369832", "respond", "2938" )' aria-label="Reply to Eduardo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-369871" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-369871" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 8, 2016 at 9:57 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-369871" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Wow, cool project Eduardo.</p>
<p>I wonder if you can cut the problem back to just the first sentence or first paragraph of the post.</p>
<p>I wonder if you can use a good word embedding.</p>
<p>I also wonder if you can use a CNN instead od LSTM to make the 
classification – or at least compare CNN alone to CNN + LSTM and double 
done on what works best.</p>
<p>Generally, here is a ton of advice for improving performance on deep learning problems:<br>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=369871#respond" onclick='return addComment.moveForm( "comment-369871", "369871", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-370297" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-370297" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/c291bd2c978cb2bff3973a224958c9c2.jpeg" srcset="http://0.gravatar.com/avatar/c291bd2c978cb2bff3973a224958c9c2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Emma</span>
	                <span class="date">November 11, 2016 at 4:24 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370297" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you for your time for this very helpful tutorial.<br>
I was wondering if you would have considered to randomly shuffle the data prior to each epoch of training?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=370297#respond" onclick='return addComment.moveForm( "comment-370297", "370297", "respond", "2938" )' aria-label="Reply to Emma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370338" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-370338" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 12, 2016 at 7:18 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370338" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Emma,</p>
<p>Great question. The data is automatically shuffled prior to each epoch by the fit() function. </p>
<p>See more about the shuffle argument to the fit() function here:<br>
<a href="https://keras.io/models/sequential/" rel="nofollow">https://keras.io/models/sequential/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=370338#respond" onclick='return addComment.moveForm( "comment-370338", "370338", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-370303" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-370303" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/be8394a7b0453e1355d17d9b34aacc2d.jpeg" srcset="http://2.gravatar.com/avatar/be8394a7b0453e1355d17d9b34aacc2d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shashank</span>
	                <span class="date">November 11, 2016 at 4:51 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370303" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Can you please show how to convert all the words to integers so that they are ready to be feed into keras models?</p>
<p>Here in IMDB they are directly working on integers but I have a 
problem where I have got many rows of text and I have to classify 
them(multiclass problem).</p>
<p>Also in LSTM+CNN i am getting an error:</p>
<p>ERROR (theano.gof.opt): Optimization failure due to: local_abstractconv_check<br>
ERROR (theano.gof.opt): node: AbstractConv2d{border_mode=’half’, 
subsample=(1, 1), filter_flip=True, imshp=(None, None, None, None), 
kshp=(None, None, None, None)}(DimShuffle{0,2,1,x}.0, 
DimShuffle{3,2,0,1}.0)<br>
ERROR (theano.gof.opt): TRACEBACK:<br>
ERROR (theano.gof.opt): Traceback (most recent call last):<br>
  File “C:\Anaconda2\lib\site-packages\theano\gof\opt.py”, line 1772, in process_node<br>
    replacements = lopt.transform(node)<br>
  File “C:\Anaconda2\lib\site-packages\theano\tensor\nnet\opt.py”, line 402, in local_abstractconv_check<br>
    node.op.__class__.__name__)<br>
AssertionError: AbstractConv2d Theano optimization failed: there is no 
implementation available supporting the requested options. Did you 
exclude both “conv_dnn” and “conv_gemm” from the optimizer? If on GPU, 
is cuDNN available and does the GPU support it? If on CPU, do you have a
 BLAS library installed Theano can link against?</p>
<p>I am running keras in windows with Theano backend and CPU only.</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=370303#respond" onclick='return addComment.moveForm( "comment-370303", "370303", "respond", "2938" )' aria-label="Reply to Shashank">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-370481" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-370481" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/2629bec5c4a20fe1d23123ef5215e05b.jpeg" srcset="http://2.gravatar.com/avatar/2629bec5c4a20fe1d23123ef5215e05b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thang Le</span>
	                <span class="date">November 14, 2016 at 4:16 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370481" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Can you tell me how the IMDB database contains its data please? Text or vector?</p>
<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=370481#respond" onclick='return addComment.moveForm( "comment-370481", "370481", "respond", "2938" )' aria-label="Reply to Thang Le">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370505" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-370505" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 14, 2016 at 7:45 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370505" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Thang Le, the IMDB dataset was originally text.</p>
<p>The words were converted to integers (one int for each word), and we 
model the data as fixed-length vectors of integers. Because we work with
 fixed-length vectors, we must truncate and/or pad the data to this 
fixed length.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=370505#respond" onclick='return addComment.moveForm( "comment-370505", "370505", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370525" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-370525" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/2629bec5c4a20fe1d23123ef5215e05b.jpeg" srcset="http://2.gravatar.com/avatar/2629bec5c4a20fe1d23123ef5215e05b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Le Thang</span>
	                <span class="date">November 14, 2016 at 2:03 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370525" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason!</p>
<p>So when we call (X_train, y_train), (X_test, y_test) = 
imdb.load_data(), X_train[i] will be vector. And if it is vector then 
how can I convert my text data to vector to use in this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=370525#respond" onclick='return addComment.moveForm( "comment-370525", "370525", "respond", "2938" )' aria-label="Reply to Le Thang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370602" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-370602" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 15, 2016 at 7:40 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370602" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Le Thang, great question.</p>
<p>You can convert each character to an integer. Then each input will be
 a vector of integers. You can then use an Embedding layer to convert 
your vectors of integers to real-valued vectors in a projected space.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=370602#respond" onclick='return addComment.moveForm( "comment-370602", "370602", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-370545" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-370545" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/fbc4dcae60fbfd39a835ef191a803fc3.jpeg" srcset="http://0.gravatar.com/avatar/fbc4dcae60fbfd39a835ef191a803fc3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Quan Xiu</span>
	                <span class="date">November 14, 2016 at 6:36 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370545" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>As I understand, X_train is a variable sequence of words in movie review for input then what does Y_train stand for?</p>
<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=370545#respond" onclick='return addComment.moveForm( "comment-370545", "370545", "respond", "2938" )' aria-label="Reply to Quan Xiu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370607" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-370607" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 15, 2016 at 7:53 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370607" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Quan Xiu, Y is the output variables and Y_train are the output variables for the training dataset.</p>
<p>For this dataset, the output values are movie sentiment values (positive or negative sentiment).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=370607#respond" onclick='return addComment.moveForm( "comment-370607", "370607", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370640" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-370640" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/fbc4dcae60fbfd39a835ef191a803fc3.jpeg" srcset="http://0.gravatar.com/avatar/fbc4dcae60fbfd39a835ef191a803fc3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Quan Xiu</span>
	                <span class="date">November 15, 2016 at 2:38 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370640" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason,</p>
<p>So when we take X_test as input, the output will be compared to y_test to compute the accuracy, right?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=370640#respond" onclick='return addComment.moveForm( "comment-370640", "370640", "respond", "2938" )' aria-label="Reply to Quan Xiu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370781" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-370781" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 16, 2016 at 9:24 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370781" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes Quan Xiu, the predictions made by the model are compared to y_test.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=370781#respond" onclick='return addComment.moveForm( "comment-370781", "370781", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-371552" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-371552" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/e7961f91f22a935b85c0d81ab33b52f6.jpeg" srcset="http://2.gravatar.com/avatar/e7961f91f22a935b85c0d81ab33b52f6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Herbert Kruitbosch</span>
	                <span class="date">November 22, 2016 at 7:47 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371552" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The performance of this LSTM-network is lower than TFIDF + Logistic Regression:</p>
<p><a href="https://gist.github.com/prinsherbert/92313f15fc814d6eed1e36ab4df1f92d" rel="nofollow">https://gist.github.com/prinsherbert/92313f15fc814d6eed1e36ab4df1f92d</a></p>
<p>Are you sure the hidden state’s aren’t just counting words in a very expensive manor?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=371552#respond" onclick='return addComment.moveForm( "comment-371552", "371552", "respond", "2938" )' aria-label="Reply to Herbert Kruitbosch">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371686" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-371686" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 23, 2016 at 8:55 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371686" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It’s true that this example is not tuned for optimal performance Herbert.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=371686#respond" onclick='return addComment.moveForm( "comment-371686", "371686", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371815" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-371815" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/e7961f91f22a935b85c0d81ab33b52f6.jpeg" srcset="http://2.gravatar.com/avatar/e7961f91f22a935b85c0d81ab33b52f6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Herbert Kruitbosch</span>
	                <span class="date">November 23, 2016 at 8:57 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371815" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This leaves a rather important question, does it actually learn 
more complicated features than word-counts? And do LSTM’s do so in 
general? Obviously there is literature out there on this topic, but I 
think your post is somewhat misleading w.r.t. power of LSTM’s. It would 
be great to see an example where an LSTM outperforms a TFIDF, and give 
an idea about the type and size of the data that you need. (Thank you 
for the quick reply though <img draggable="false" class="emoji" alt="🙂" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1f642.svg"> )</p>
<p>LSTM’s are only neat if they actually remember contextual things, not
 if they just fit simple models and take a long time to do so.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=371815#respond" onclick='return addComment.moveForm( "comment-371815", "371815", "respond", "2938" )' aria-label="Reply to Herbert Kruitbosch">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371935" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-371935" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 24, 2016 at 10:39 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371935" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I agree Herbert. </p>
<p>LSTMs are hard to use. Initially, I wanted to share how to get up and
 running with the technique. I aim to come back to this example and test
 new configurations to get more/most from the method.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=371935#respond" onclick='return addComment.moveForm( "comment-371935", "371935", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-374239" class="comment odd alt depth-5">

	      	<div id="li-comment-374239" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/e7961f91f22a935b85c0d81ab33b52f6.jpeg" srcset="http://2.gravatar.com/avatar/e7961f91f22a935b85c0d81ab33b52f6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Herbert Kruitbosch</span>
	                <span class="date">December 8, 2016 at 12:29 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374239" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That would be great! It would also be nice to get an idea about 
the size of data needed for good performance (and of course, there are 
thousands of other open questions :))</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-371623" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-371623" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/2f79a55b3f7328b801912e7a9321ac14.jpeg" srcset="http://2.gravatar.com/avatar/2f79a55b3f7328b801912e7a9321ac14?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Huy Huynh</span>
	                <span class="date">November 23, 2016 at 4:08 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371623" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Many thank your post, Jason. It’s helpful</p>
<p>I have some short questions. First, I feel nervous when chose 
hyperparameter for the model such as  length vectors (32), a number of 
Embedding unit (500), a number of LSTM unit(100), most frequent 
words(5000). It depends on dataset, doesn’t it? How can we choose 
parameter?</p>
<p>Second, I have dataset about news daily for predicting the movement 
of price stock market. But, each news seems more  words than each 
comment imdb dataset. Average each news about 2000 words, can you 
recommend me how I can choose approximate hyperparameter.</p>
<p>Thank you, (P/s sorry about my English if have any mistake)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=371623#respond" onclick='return addComment.moveForm( "comment-371623", "371623", "respond", "2938" )' aria-label="Reply to Huy Huynh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371697" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-371697" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 23, 2016 at 9:03 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371697" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Huy,</p>
<p>We have to choose something. It is good practice to grid search over 
each of these parameters and select for best performance and model 
robustness.</p>
<p>Perhaps you can work with the top n most common words only.<br>
Perhaps you can use a projection or embedding of the article.<br>
Perhaps you can use some classical NLP methods on the text first.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=371697#respond" onclick='return addComment.moveForm( "comment-371697", "371697", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371875" class="comment even depth-3">

	      	<div id="li-comment-371875" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/2f79a55b3f7328b801912e7a9321ac14.jpeg" srcset="http://2.gravatar.com/avatar/2f79a55b3f7328b801912e7a9321ac14?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Huy Huynh</span>
	                <span class="date">November 24, 2016 at 3:47 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371875" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your quick response,</p>
<p> I am a newbie in Deep Learning, It seems really difficult to choose relevant parameters.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=371875#respond" onclick='return addComment.moveForm( "comment-371875", "371875", "respond", "2938" )' aria-label="Reply to Huy Huynh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-371625" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-371625" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/2f79a55b3f7328b801912e7a9321ac14.jpeg" srcset="http://2.gravatar.com/avatar/2f79a55b3f7328b801912e7a9321ac14?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Huy Huynh</span>
	                <span class="date">November 23, 2016 at 4:16 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371625" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>According to my understanding, When training, the number of epoch
 often more than 100 to evaluate supervised machine learning result. 
But, In your example or Keras sample, It’s only between 3-15 epochs. Can
 you explain about that?<br>
Thanks,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=371625#respond" onclick='return addComment.moveForm( "comment-371625", "371625", "respond", "2938" )' aria-label="Reply to Huy Huynh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371698" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-371698" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 23, 2016 at 9:03 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371698" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Epochs can vary from algorithm and problem. There are no rules Huy, let results guide everything.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=371698#respond" onclick='return addComment.moveForm( "comment-371698", "371698", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371877" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-371877" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/2f79a55b3f7328b801912e7a9321ac14.jpeg" srcset="http://2.gravatar.com/avatar/2f79a55b3f7328b801912e7a9321ac14?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Huy Huynh</span>
	                <span class="date">November 24, 2016 at 3:49 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371877" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>So, How we can choose the relevant number of epochs?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=371877#respond" onclick='return addComment.moveForm( "comment-371877", "371877", "respond", "2938" )' aria-label="Reply to Huy Huynh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371937" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-371937" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 24, 2016 at 10:41 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371937" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Trial and error on your problem, and carefully watch the learning rate on your training and validation datasets.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=371937#respond" onclick='return addComment.moveForm( "comment-371937", "371937", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-372597" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-372597" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/ffa50b2ca24453993f3a1aaefc6db603.jpeg" srcset="http://0.gravatar.com/avatar/ffa50b2ca24453993f3a1aaefc6db603?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Søren Pallesen</span>
	                <span class="date">November 27, 2016 at 8:08 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-372597" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Im looking for benchmarks of LSTM networks on Keras with known/public datasets. </p>
<p>Could you share what hardware configuration the examples in this post was run on (GPU/CPU/RAM etc)?</p>
<p>Thx</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=372597#respond" onclick='return addComment.moveForm( "comment-372597", "372597", "respond", "2938" )' aria-label="Reply to Søren Pallesen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-372665" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-372665" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 28, 2016 at 8:43 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-372665" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I used AWS with the g2.2xlarge configuration.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=372665#respond" onclick='return addComment.moveForm( "comment-372665", "372665", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-373026" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-373026" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/857eeb2bd390e04728d61d045c05a73b.jpeg" srcset="http://2.gravatar.com/avatar/857eeb2bd390e04728d61d045c05a73b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mike</span>
	                <span class="date">November 30, 2016 at 11:41 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-373026" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is it possible in Keras to obtain the classifier output as each word propagates through the network?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=373026#respond" onclick='return addComment.moveForm( "comment-373026", "373026", "respond", "2938" )' aria-label="Reply to Mike">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-373151" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-373151" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 1, 2016 at 7:14 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-373151" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Mike, you can make one prediction at a time. </p>
<p>Not sure about seeing how the weights propagate through – I have not done this myself with Keras.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=373151#respond" onclick='return addComment.moveForm( "comment-373151", "373151", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-374418" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-374418" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/f69ab52145bfc499bd9d60d69b6b1ffe.jpeg" srcset="http://0.gravatar.com/avatar/f69ab52145bfc499bd9d60d69b6b1ffe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">lim</span>
	                <span class="date">December 9, 2016 at 4:50 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374418" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>What are some of the changes you have to make in your binary classification model to work for the multi-label classification?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=374418#respond" onclick='return addComment.moveForm( "comment-374418", "374418", "respond", "2938" )' aria-label="Reply to lim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-374470" class="comment even depth-2">

	      	<div id="li-comment-374470" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/f69ab52145bfc499bd9d60d69b6b1ffe.jpeg" srcset="http://0.gravatar.com/avatar/f69ab52145bfc499bd9d60d69b6b1ffe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">lim</span>
	                <span class="date">December 9, 2016 at 11:03 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374470" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>also instead of a given input data such as imdb in number digit 
format, what steps do you take to process your raw text format dataset 
to make it compatible like imdb?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=374470#respond" onclick='return addComment.moveForm( "comment-374470", "374470", "respond", "2938" )' aria-label="Reply to lim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-374455" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-374455" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/3af77b049a18bd38b8c485e5115b81e0.jpeg" srcset="http://0.gravatar.com/avatar/3af77b049a18bd38b8c485e5115b81e0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hossein</span>
	                <span class="date">December 9, 2016 at 9:19 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374455" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great Job Jason. </p>
<p>I liked it very much…<br>
I would really appreciate it if you tell me how we can do Sequence 
Clustering with LSTM Recurrent Neural Networks (Unsupervised learning 
task).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=374455#respond" onclick='return addComment.moveForm( "comment-374455", "374455", "respond", "2938" )' aria-label="Reply to Hossein">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-374609" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-374609" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 10, 2016 at 8:01 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374609" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I have not used LSTMs for clustering. I don’t have good advice for you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=374609#respond" onclick='return addComment.moveForm( "comment-374609", "374609", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-374691" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-374691" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/54e962919a62bf94429f737adfda72fe.jpeg" srcset="http://2.gravatar.com/avatar/54e962919a62bf94429f737adfda72fe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ryan</span>
	                <span class="date">December 10, 2016 at 8:56 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374691" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Your book is really helpful for me. I have a question about time 
sequence classifier. Let’s say, I have 8 classes of time sequence data, 
each class has 200 training data and 50 validation data, how can I 
estimate the classification accuracy based on all the 50 validation data
 per class (sth. like log-maximum likelihood) using scikit-learn package
 or sth. else? It would be very appreciated that you could give me some 
advice. Thanks a lot in advance.</p>
<p>Best regards,<br>
Ryan</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=374691#respond" onclick='return addComment.moveForm( "comment-374691", "374691", "respond", "2938" )' aria-label="Reply to ryan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-374749" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-374749" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 11, 2016 at 5:26 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374749" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Ryan, this list of classification measures supported by sklearn might help as a start:<br>
<a href="http://scikit-learn.org/stable/modules/classes.html#classification-metrics" rel="nofollow">http://scikit-learn.org/stable/modules/classes.html#classification-metrics</a></p>
<p>Logloss is a very useful measure for evaluating the performance of learning algorithms on multi-class classification problems:<br>
<a href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.log_loss.html#sklearn.metrics.log_loss" rel="nofollow">http://scikit-learn.org/stable/modules/generated/sklearn.metrics.log_loss.html#sklearn.metrics.log_loss</a></p>
<p>I hope that helps as a start.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=374749#respond" onclick='return addComment.moveForm( "comment-374749", "374749", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-374764" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-374764" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/54e962919a62bf94429f737adfda72fe.jpeg" srcset="http://2.gravatar.com/avatar/54e962919a62bf94429f737adfda72fe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ryan</span>
	                <span class="date">December 11, 2016 at 8:25 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374764" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, Thank you so much. I will try this logloss.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=374764#respond" onclick='return addComment.moveForm( "comment-374764", "374764", "respond", "2938" )' aria-label="Reply to ryan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-374872" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-374872" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 12, 2016 at 6:45 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374872" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Let me know how you go.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=374872#respond" onclick='return addComment.moveForm( "comment-374872", "374872", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-374934" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-374934" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/be8394a7b0453e1355d17d9b34aacc2d.jpeg" srcset="http://2.gravatar.com/avatar/be8394a7b0453e1355d17d9b34aacc2d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shashank</span>
	                <span class="date">December 12, 2016 at 5:09 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374934" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Which approach is better Bags of words or word embedding for converting text to integer for correct and better classification?</p>
<p>I am a little confused in this.</p>
<p>Thanks in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=374934#respond" onclick='return addComment.moveForm( "comment-374934", "374934", "respond", "2938" )' aria-label="Reply to Shashank">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-375010" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-375010" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 13, 2016 at 8:05 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-375010" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Shashank, embeddings are popular at the moment. I would suggest both and see what representation works best for you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=375010#respond" onclick='return addComment.moveForm( "comment-375010", "375010", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-375874" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-375874" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/2ea625db98ee53bac98c62037983099f.jpeg" srcset="http://2.gravatar.com/avatar/2ea625db98ee53bac98c62037983099f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mango</span>
	                <span class="date">December 19, 2016 at 1:34 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-375874" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thank you for your tutorials, I find them very clear 
and useful, but I have a little question when I try to use it to another
 problem setting..</p>
<p>as is pointed out in your post, words are embedding as vectors, and 
we feed a sequence of vectors to the model, to do classification.. as 
you mentioned cnn to deal with the implicit spatial relation inside the 
word vector(hope I got it right), so I have two questions related to 
this operation:</p>
<p>1. Is the Embedding layer specific to word, that said, keras has its 
own vocabulary and similarity definition to treat our feeded word 
sequence?</p>
<p>2. What if I have a sequence of 2d matrix, something like an image, 
how should I transform them to meet the required input shape to the CNN 
layer or directly the LSTM layer? For example, combined with your 
tutorial for the time series data, I got an trainX of size (5000, 5, 14,
 13), where 5000 is the length of my samples, and 5 is the look_back (or
 time_step), while I have a matrix instead of a single value here, but I
 think I should use my specific Embedding technique here so I could pass
 a matrix instead of a vector before an CNN or a LSTM layer….</p>
<p>Sorry if my question is not described well, but my intention is 
really to get the temporal-spatial connection lie in my data… so I want 
to feed into my model with a sequence of matrix as one sample.. and the 
output will be one matrix..</p>
<p>thank you for your patience!!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=375874#respond" onclick='return addComment.moveForm( "comment-375874", "375874", "respond", "2938" )' aria-label="Reply to Mango">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-376096" class="comment even thread-even depth-1">

	      	<div id="li-comment-376096" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/2d078dab70121c6249559fa73fc88c85.jpeg" srcset="http://2.gravatar.com/avatar/2d078dab70121c6249559fa73fc88c85?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Banbhrani</span>
	                <span class="date">December 19, 2016 at 7:04 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-376096" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>33202176/33213513 [============================&gt;.] – ETA: 0s  
 19800064/33213513 [================&gt;………….] – ETA: 207s – ETA: 
194s____________________________________________________________________________________________________<br>
Layer (type)                     Output Shape          Param #     Connected to<br>
====================================================================================================<br>
embedding_1 (Embedding)          (None, 500, 32)       160000      embedding_input_1[0][0]<br>
____________________________________________________________________________________________________<br>
lstm_1 (LSTM)                    (None, 100)           53200       embedding_1[0][0]<br>
____________________________________________________________________________________________________<br>
dense_1 (Dense)                  (None, 1)             101         lstm_1[0][0]<br>
====================================================================================================<br>
Total params: 213301<br>
____________________________________________________________________________________________________<br>
None<br>
Epoch 1/3</p>
<p>Kernel died, restarting</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=376096#respond" onclick='return addComment.moveForm( "comment-376096", "376096", "respond", "2938" )' aria-label="Reply to Banbhrani">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-381320" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-381320" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/db981cdf6f8c6ad8efc2a82af54341c1.jpeg" srcset="http://1.gravatar.com/avatar/db981cdf6f8c6ad8efc2a82af54341c1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eka</span>
	                <span class="date">January 10, 2017 at 12:49 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381320" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Thanks for the nice article. Because IMDb data is very large I tried to 
replace it with spam dataset. What kind of changes should I make in the 
original code to run it. I have asked this question in stack-overflow 
but sofar no answer. <a href="http://stackoverflow.com/questions/41322243/how-to-use-keras-rnn-for-text-classification-in-a-dataset" rel="nofollow">http://stackoverflow.com/questions/41322243/how-to-use-keras-rnn-for-text-classification-in-a-dataset</a> ?</p>
<p>Any help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=381320#respond" onclick='return addComment.moveForm( "comment-381320", "381320", "respond", "2938" )' aria-label="Reply to Eka">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-381420" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-381420" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 11, 2017 at 9:25 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381420" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great idea!</p>
<p>I would suggest you encode each word as a unique integer. Then you can start using it as an input for the Embedding layer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=381420#respond" onclick='return addComment.moveForm( "comment-381420", "381420", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-381403" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-381403" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/38650c7f5b3ec63b38698947dae56b57.jpeg" srcset="http://0.gravatar.com/avatar/38650c7f5b3ec63b38698947dae56b57?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">AKSHAY</span>
	                <span class="date">January 11, 2017 at 6:55 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381403" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the post. It is really helpful. Do I need to configure for
 the tensorflow to make use of GPU when I run this code or does it 
automatically select GPU if its available?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=381403#respond" onclick='return addComment.moveForm( "comment-381403", "381403", "respond", "2938" )' aria-label="Reply to AKSHAY">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-381427" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-381427" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 11, 2017 at 9:31 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381427" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>These examples are small and run fast on the CPU, no GPU is required.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=381427#respond" onclick='return addComment.moveForm( "comment-381427", "381427", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-381445" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-381445" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/38650c7f5b3ec63b38698947dae56b57.jpeg" srcset="http://0.gravatar.com/avatar/38650c7f5b3ec63b38698947dae56b57?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">AKSHAY</span>
	                <span class="date">January 11, 2017 at 12:49 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381445" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I tried it on CPU and it worked fine. I plan to replicate the 
process and expand your method for a different use case. Its high 
dimensional compared to this. Do you have a tutorial on making use of 
GPU as well? Can I implement the same code in gpu or is the format all 
different?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=381445#respond" onclick='return addComment.moveForm( "comment-381445", "381445", "respond", "2938" )' aria-label="Reply to AKSHAY">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-381592" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-381592" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 12, 2017 at 9:24 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381592" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Same code, use of the backend is controlled by the Theano or TensorFlow backend that you’re using.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=381592#respond" onclick='return addComment.moveForm( "comment-381592", "381592", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-381552" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-381552" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/851f009dd4de5daa0c94ec6cd970ac06.jpeg" srcset="http://2.gravatar.com/avatar/851f009dd4de5daa0c94ec6cd970ac06?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Stan</span>
	                <span class="date">January 12, 2017 at 4:12 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381552" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason,</p>
<p>Thanks for the interesting tutorial! Do you have any thoughts on how 
the LSTM trained to classify sequences could then be turned around to 
generate new ones? I.e. now that it “knows” what a positive review 
sounds like, could it be used to generate new and novel positive 
reviews? (ignore possible nefarious uses for such a setup <img draggable="false" class="emoji" alt="🙂" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1f642.svg"> )</p>
<p>There are several interesting examples of LSTMs being trained to 
learn sequences to generate new ones… however, they have no concept of 
classification, or understanding what a “good” vs “bad” sequence is, 
like yours does. So, I’m essentially interested in merging the two 
approaches — train an LSTM with a number of “good” and “bad” sequences, 
and then have it generate new “good” ones.</p>
<p>Any thoughts or pointers would be very welcome!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=381552#respond" onclick='return addComment.moveForm( "comment-381552", "381552", "respond", "2938" )' aria-label="Reply to Stan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-381600" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-381600" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 12, 2017 at 9:37 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381600" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have not explored this myself. I don’t have any offhand quips, it requires careful thought I think.</p>
<p>This post might help with the other side of the coin, the generation of text:<br>
<a href="http://machinelearningmastery.com/text-generation-lstm-recurrent-neural-networks-python-keras/" rel="nofollow">http://machinelearningmastery.com/text-generation-lstm-recurrent-neural-networks-python-keras/</a></p>
<p>I would love to hear how you get on.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=381600#respond" onclick='return addComment.moveForm( "comment-381600", "381600", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-381746" class="comment odd alt depth-3">

	      	<div id="li-comment-381746" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/851f009dd4de5daa0c94ec6cd970ac06.jpeg" srcset="http://2.gravatar.com/avatar/851f009dd4de5daa0c94ec6cd970ac06?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Stan</span>
	                <span class="date">January 13, 2017 at 1:31 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381746" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, if you do come up with any crazy ideas, please let me know :).</p>
<p>One pedestrian approach I’m thinking off is having the classifier 
used to simply “weed out” the undesired inputs, and then feed only 
desired ones into a new LSTM which can then be used to generate more 
sequences like those, using the approach like the one in your other 
post.</p>
<p>That doesn’t seem ideal, as it feels like I’m throwing away some of 
the knowledge about what makes an undesired sequence undesired… But, on 
the other hand, I have more freedom in selecting the classifier 
algorithm.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=381746#respond" onclick='return addComment.moveForm( "comment-381746", "381746", "respond", "2938" )' aria-label="Reply to Stan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-384456" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-384456" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/df98197d62849c803bfe23ff61477e6a.jpeg" srcset="http://1.gravatar.com/avatar/df98197d62849c803bfe23ff61477e6a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Albert</span>
	                <span class="date">January 27, 2017 at 9:03 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-384456" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for this tutorial.</p>
<p>Regarding the variable length problem, though other people have asked about it, I have a further question.</p>
<p>If I have a dataset with high deviation of length, say, some text has
 10 words, some has 100000 words. Therefore, if I just choose 1000 as my
 maxlen, I lost a lot of information.</p>
<p>If I choose 100000 as the maxlen, I consume too much computational power.</p>
<p>Is there a another way of dealing with that? (Without padding or truncating)</p>
<p>Also, can you write a tutorial about how to use word2vec pretrained embedding with RNN?</p>
<p>Not word2vec itself, but how to use the result of word2vec.</p>
<p>The counting based word representation lost too much semantic information.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=384456#respond" onclick='return addComment.moveForm( "comment-384456", "384456", "respond", "2938" )' aria-label="Reply to Albert">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-384509" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-384509" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 27, 2017 at 12:28 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-384509" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great questions Albert.</p>
<p>I don’t have a good off-the-cuff answer for you re long sequences. It requires further research.</p>
<p>Keen to tackle the suggested tutorial using word2vc representations.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=384509#respond" onclick='return addComment.moveForm( "comment-384509", "384509", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-384813" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-384813" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/9a7b9d511f1d9cc5b9437af5e8ad8d14.jpeg" srcset="http://0.gravatar.com/avatar/9a7b9d511f1d9cc5b9437af5e8ad8d14?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Charles</span>
	                <span class="date">January 29, 2017 at 4:33 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-384813" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I only have biology background, but I can reproduced the results. Great.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=384813#respond" onclick='return addComment.moveForm( "comment-384813", "384813", "respond", "2938" )' aria-label="Reply to Charles">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-385385" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-385385" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 1, 2017 at 10:11 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-385385" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear it Charles.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=385385#respond" onclick='return addComment.moveForm( "comment-385385", "385385", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-385346" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-385346" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/78c2091c14057cdb27809c6da60b4280.jpeg" srcset="http://1.gravatar.com/avatar/78c2091c14057cdb27809c6da60b4280?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jax</span>
	                <span class="date">February 1, 2017 at 6:27 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-385346" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, i noted you mentioned updated examples for Tensorflow 0.10.0. I can only see Keras codes, am i missing something?</p>
<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=385346#respond" onclick='return addComment.moveForm( "comment-385346", "385346", "respond", "2938" )' aria-label="Reply to Jax">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-385427" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-385427" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 1, 2017 at 10:54 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-385427" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jax,</p>
<p>Keras runs on top of Theano and TensorFlow. One or the other are required to use Keras.</p>
<p>I was leaving a note that the example was tested on an updated 
version of Keras using an updated version of the TensorFlow backend.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=385427#respond" onclick='return addComment.moveForm( "comment-385427", "385427", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-387627" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-387627" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/7acc22a63aea1741a2cb2bfe0c01607c.jpeg" srcset="http://1.gravatar.com/avatar/7acc22a63aea1741a2cb2bfe0c01607c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kakaio</span>
	                <span class="date">February 13, 2017 at 8:30 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-387627" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am not sure I understand how recurrence and sequence work here.<br>
I would expect you’d feed a sequence of one-hot vectors for each review,
 where each one-hot vector represents one word. This way, you would not 
need a maximum length for the review (nor padding), and I could see how 
you’d use recurrence one word at a time.<br>
But I understand you’re feeding the whole review in one go, so it looks like e feedforward.<br>
Can you explain that?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=387627#respond" onclick='return addComment.moveForm( "comment-387627", "387627", "respond", "2938" )' aria-label="Reply to Kakaio">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-387642" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-387642" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 13, 2017 at 9:16 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-387642" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Kakaio,</p>
<p>Yes, indeed we are feeding one review at a time. It is the input structured we’d use for a MLP.</p>
<p>Internally, consider the LSTM network as building up state on the 
sequence of words in the review and from that sequence learning the 
appropriate sentiment.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=387642#respond" onclick='return addComment.moveForm( "comment-387642", "387642", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-387644" class="comment even depth-3 parent">

	      	<div id="li-comment-387644" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/7acc22a63aea1741a2cb2bfe0c01607c.jpeg" srcset="http://1.gravatar.com/avatar/7acc22a63aea1741a2cb2bfe0c01607c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kakaop</span>
	                <span class="date">February 13, 2017 at 9:42 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-387644" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>how is the LSTM building up state one the sequence of words 
leveraging recurrence? you’re feeding the LSTM all the sequence at the 
same time, there’re no time steps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=387644#respond" onclick='return addComment.moveForm( "comment-387644", "387644", "respond", "2938" )' aria-label="Reply to Kakaop">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-387645" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-387645" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 13, 2017 at 9:53 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-387645" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Kakaop, quite right. The example does not leverage recurrence.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=387645#respond" onclick='return addComment.moveForm( "comment-387645", "387645", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-390795" class="comment even thread-even depth-1">

	      	<div id="li-comment-390795" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/a6632f4cb6c59d006bef98ef15208ec2.jpeg" srcset="http://1.gravatar.com/avatar/a6632f4cb6c59d006bef98ef15208ec2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sweta</span>
	                <span class="date">March 1, 2017 at 8:15 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-390795" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>From this tutorial how can I predict the test values and how to 
write to a file? Are these predicted values generate in the encoded 
format?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=390795#respond" onclick='return addComment.moveForm( "comment-390795", "390795", "respond", "2938" )' aria-label="Reply to Sweta">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-390885" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-390885" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/c0aa3f8750834c630cdf6805f7c51f32.jpeg" srcset="http://0.gravatar.com/avatar/c0aa3f8750834c630cdf6805f7c51f32?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bruce Ho</span>
	                <span class="date">March 2, 2017 at 9:29 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-390885" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Guys, this is a very clear and useful article, and thanks for the
 Keras code. But I can’t seem to find any sample code for running the 
trained model to make a prediction. It is not in imdb.py, that just does
 the evaluation. Does any one have some sample code for prediction to 
show?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=390885#respond" onclick='return addComment.moveForm( "comment-390885", "390885", "respond", "2938" )' aria-label="Reply to Bruce Ho">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-391013" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-391013" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 3, 2017 at 7:39 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-391013" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Bruce,</p>
<p>You can fit the model on all of the training data, than forecast for new inputs using:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb972a33562890990" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">y = model.predict(X)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb972a33562890990-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb972a33562890990-1"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=391013#respond" onclick='return addComment.moveForm( "comment-391013", "391013", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-391068" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-391068" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/c0aa3f8750834c630cdf6805f7c51f32.jpeg" srcset="http://0.gravatar.com/avatar/c0aa3f8750834c630cdf6805f7c51f32?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bruce Ho</span>
	                <span class="date">March 3, 2017 at 4:47 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-391068" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That’s not the hard part. However, I may have figured out what I 
need to know. That is take the result returned by model.predict and take
 the last item in the array as the classifications. Any one disagrees?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=391068#respond" onclick='return addComment.moveForm( "comment-391068", "391068", "respond", "2938" )' aria-label="Reply to Bruce Ho">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-393066" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-393066" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/219d8df803b9377c7026529a7c6e54fa.jpeg" srcset="http://2.gravatar.com/avatar/219d8df803b9377c7026529a7c6e54fa?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">JUNETAE KIM</span>
	                <span class="date">March 17, 2017 at 10:40 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-393066" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, it’s the awesome tutorial.  </p>
<p>I have a question regarding your model. </p>
<p>I am new to RNN, so the question would be stupid. </p>
<p>Inputting word embedding layer is crucial in your setting – sequence classification rather than prediction of the next word??</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=393066#respond" onclick='return addComment.moveForm( "comment-393066", "393066", "respond", "2938" )' aria-label="Reply to JUNETAE KIM">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-393121" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-393121" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 18, 2017 at 7:48 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-393121" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Generally, a word embedding (or similar projection) is a good representation for NLP problems.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=393121#respond" onclick='return addComment.moveForm( "comment-393121", "393121", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-393940" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-393940" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/123b6dfc2d9dd9ce31452a80a7cc7035.jpeg" srcset="http://1.gravatar.com/avatar/123b6dfc2d9dd9ce31452a80a7cc7035?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">DanielHa</span>
	                <span class="date">March 24, 2017 at 2:41 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-393940" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
great tutorial. Really helped me alot.</p>
<p>I’ve noticed that in the first part you called fit() on the model 
with “validation_data=(X_test, y_test)”. This isn’t in the final code 
summary. So I wondered if that’s just a mistake or if you forgot it 
later on.</p>
<p>But then again it seems wrong to me to use the test data set for validation. What are your thoughts on this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=393940#respond" onclick='return addComment.moveForm( "comment-393940", "393940", "respond", "2938" )' aria-label="Reply to DanielHa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-393978" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-393978" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 24, 2017 at 8:00 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-393978" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The model does not use the test data at this point, it is just 
evaluated on it. It helps to get an idea of how well the model is doing.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=393978#respond" onclick='return addComment.moveForm( "comment-393978", "393978", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-394034" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-394034" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/567f511351a57eb671beb3783aa0801e.jpeg" srcset="http://2.gravatar.com/avatar/567f511351a57eb671beb3783aa0801e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Liam</span>
	                <span class="date">March 24, 2017 at 6:25 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394034" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What happen if the code uses LSTM with 100 units and sentence 
length is 200. Does that mean only the first 100 words in the sentence 
act as inputs, and the last 100 words will be ignored?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=394034#respond" onclick='return addComment.moveForm( "comment-394034", "394034", "respond", "2938" )' aria-label="Reply to Liam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394099" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-394099" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 25, 2017 at 7:34 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394099" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, the number of units in the hidden layer and the length of sequences are different configuration parameters. </p>
<p>You can have 1 unit with 2K sequence length if you like, the model just won’t learn it.</p>
<p>I hope that helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=394099#respond" onclick='return addComment.moveForm( "comment-394099", "394099", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-394477" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-394477" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/123b6dfc2d9dd9ce31452a80a7cc7035.jpeg" srcset="http://1.gravatar.com/avatar/123b6dfc2d9dd9ce31452a80a7cc7035?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Danielha</span>
	                <span class="date">March 28, 2017 at 7:29 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394477" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
in the last part the LSTM layer returns a sequence, right? And after 
that the dense layer only takes one parameter. How does the dense layer 
know that it should take the last parameter? Or does it even take the 
last parameter?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=394477#respond" onclick='return addComment.moveForm( "comment-394477", "394477", "respond", "2938" )' aria-label="Reply to Danielha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394556" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-394556" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 29, 2017 at 9:06 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394556" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, in this case each LSTM unit is not returning a sequence, just a single value.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=394556#respond" onclick='return addComment.moveForm( "comment-394556", "394556", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-394485" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-394485" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/7fe880fc00c371c9a3e10a8728e868ce.jpeg" srcset="http://1.gravatar.com/avatar/7fe880fc00c371c9a3e10a8728e868ce?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://sites.google.com/view/prashanth-r" rel="external nofollow" class="url">Prashanth R</a></span>
	                <span class="date">March 28, 2017 at 9:25 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394485" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Very interesting and useful article. Thank you for writing such useful 
articles. I have had the privilege of going through your other articles 
which are very useful. </p>
<p>Just wanted to ask, how do we encode a new test data to make same 
format as required for the program. There is no dictionary involved i 
guess for the conversion. So how can we go about for this conversion? 
For instance, consider a sample sentence “Very interesting article on 
sequence classification”. What will be encoded numeric representation?<br>
Thanks in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=394485#respond" onclick='return addComment.moveForm( "comment-394485", "394485", "respond", "2938" )' aria-label="Reply to Prashanth R">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394558" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-394558" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 29, 2017 at 9:07 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394558" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question.</p>
<p>You can encode the chars as integers (integer encode), then encode the integers as boolean vectors (one hot encode).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=394558#respond" onclick='return addComment.moveForm( "comment-394558", "394558", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401059" class="comment even depth-3 parent">

	      	<div id="li-comment-401059" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/80706160bd88c664c8b7ad40c7423e60.jpeg" srcset="http://2.gravatar.com/avatar/80706160bd88c664c8b7ad40c7423e60?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Manish Sihag</span>
	                <span class="date">June 1, 2017 at 11:13 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401059" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great article Jason. I wanted to continue the question Prashanth 
asked, how to pre-process the user input. If we use CountVectorizer() 
sure, it will convert it in the required form but then words will not be
 same as before. Even a single new word will create extra element. Can 
you please explain, how to pre-process the user input such that it 
resembles with the trained model. Thanks in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=401059#respond" onclick='return addComment.moveForm( "comment-401059", "401059", "respond", "2938" )' aria-label="Reply to Manish Sihag">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401236" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-401236" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 2, 2017 at 1:00 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401236" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can allocate an alphabet of 1M words, all integers from 1 to 1M, then use that encoding for any words you see.</p>
<p>The idea is to have a buffer in your encoding scheme.</p>
<p>Also, if you drop all low-frequency words, this will give you more buffer. Often 25K words is more than enough.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=401236#respond" onclick='return addComment.moveForm( "comment-401236", "401236", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401456" class="comment even depth-5">

	      	<div id="li-comment-401456" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/80706160bd88c664c8b7ad40c7423e60.jpeg" srcset="http://2.gravatar.com/avatar/80706160bd88c664c8b7ad40c7423e60?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Manish Sihag</span>
	                <span class="date">June 4, 2017 at 4:56 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401456" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Your answer honestly cleared many doubts. Thanks a lot for the quick reply. I have an idea now about, what to do.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-401517" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-401517" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 5, 2017 at 7:39 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401517" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad to hear that Manish.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-394629" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-394629" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/dbc112a220b4c0d6f974b07f7e032ff9.jpeg" srcset="http://1.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">trangtruong</span>
	                <span class="date">March 29, 2017 at 7:19 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394629" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have dataset just a vector feature like [1, 0,5,1,1,2,1] -&gt; y
 just 0,1 binary or category like 0,1,2,3. I want to use LSTM to 
classify binary or category, how can i do it guys, i just add LSTM with 
Dense, but LSTM need input 3 dimension but Dense just 2 dimension. I 
know i need time sequence, i try to find out more but can’t get nothing.
 Can u explain and tell me how. pls, Thank you so much</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=394629#respond" onclick='return addComment.moveForm( "comment-394629", "394629", "respond", "2938" )' aria-label="Reply to trangtruong">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394699" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-394699" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 30, 2017 at 8:51 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394699" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You may want to consider a seq2seq structure with an encoder for the input sequence and a decoder for the output sequence.</p>
<p>Something like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5996dbb9725ea357487225" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># encoder
model.add(LSTM(3, ...))
# mapping
model.add(RepeatVector(2))
# decoder
model.add(LSTM(2, return_sequences=True))
model.add(Dense(2))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5996dbb9725ea357487225-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb9725ea357487225-2">2</div><div class="crayon-num" data-line="crayon-5996dbb9725ea357487225-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb9725ea357487225-4">4</div><div class="crayon-num" data-line="crayon-5996dbb9725ea357487225-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5996dbb9725ea357487225-6">6</div><div class="crayon-num" data-line="crayon-5996dbb9725ea357487225-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5996dbb9725ea357487225-1"><span class="crayon-p"># encoder</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb9725ea357487225-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb9725ea357487225-3"><span class="crayon-p"># mapping</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb9725ea357487225-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">RepeatVector</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb9725ea357487225-5"><span class="crayon-p"># decoder</span></div><div class="crayon-line crayon-striped-line" id="crayon-5996dbb9725ea357487225-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5996dbb9725ea357487225-7"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>I have a tutorial on this scheduled.</p>
<p>I hope that helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=394699#respond" onclick='return addComment.moveForm( "comment-394699", "394699", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394755" class="comment even depth-3 parent">

	      	<div id="li-comment-394755" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/dbc112a220b4c0d6f974b07f7e032ff9.jpeg" srcset="http://1.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">trangtruong</span>
	                <span class="date">March 30, 2017 at 5:51 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394755" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thanks you, i will try to find out, then response you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=394755#respond" onclick='return addComment.moveForm( "comment-394755", "394755", "respond", "2938" )' aria-label="Reply to trangtruong">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394833" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-394833" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 31, 2017 at 5:51 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394833" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=394833#respond" onclick='return addComment.moveForm( "comment-394833", "394833", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-394757" class="comment even depth-3 parent">

	      	<div id="li-comment-394757" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/dbc112a220b4c0d6f974b07f7e032ff9.jpeg" srcset="http://1.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">trangtruong</span>
	                <span class="date">March 30, 2017 at 6:17 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394757" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ay, i have 1 question in another your post  about why i use 
function evaluate model.evaluate(x_test, y_test) to get accuracy score 
of model after train with train dataset , but its return result &gt;1 in
 some case, i don’t know why, it make me can’t beleive in this function.
 Can you explain for me why?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=394757#respond" onclick='return addComment.moveForm( "comment-394757", "394757", "respond", "2938" )' aria-label="Reply to trangtruong">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394834" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-394834" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 31, 2017 at 5:52 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394834" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry I don’t understand your question, perhaps you can rephrase it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=394834#respond" onclick='return addComment.moveForm( "comment-394834", "394834", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394884" class="comment even depth-5">

	      	<div id="li-comment-394884" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/dbc112a220b4c0d6f974b07f7e032ff9.jpeg" srcset="http://1.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">trangtruong</span>
	                <span class="date">March 31, 2017 at 12:34 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394884" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t know the result return by function evaluate &gt;1, but i 
thinks it should just from 0 -&gt; 1  ( model.evaluate(x_test,y_test) 
with model i had trained it before with train dataset)</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-394781" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-394781" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/dbc112a220b4c0d6f974b07f7e032ff9.jpeg" srcset="http://1.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">trangtruong</span>
	                <span class="date">March 30, 2017 at 9:07 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394781" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, Can you explain your code step by step Jason, i have follow tutorial : <a href="https://blog.keras.io/building-autoencoders-in-keras.html" rel="nofollow">https://blog.keras.io/building-autoencoders-in-keras.html</a> but i have some confused to understand. :(.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=394781#respond" onclick='return addComment.moveForm( "comment-394781", "394781", "respond", "2938" )' aria-label="Reply to trangtruong">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394842" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-394842" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 31, 2017 at 5:54 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394842" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you have questions about that post, I would recommend contacting the author.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=394842#respond" onclick='return addComment.moveForm( "comment-394842", "394842", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-395525" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-395525" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/04dffb6f90d485a8a7204c43b4e9a24b.jpeg" srcset="http://0.gravatar.com/avatar/04dffb6f90d485a8a7204c43b4e9a24b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mazhar Ali</span>
	                <span class="date">April 6, 2017 at 7:36 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-395525" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dear Joson<br>
I am new to deep learning and intends to work on keras or tensorflow for
 corpus analysis. May you help me or send me basic tutorials<br>
regards<br>
Mazhar Ali</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=395525#respond" onclick='return addComment.moveForm( "comment-395525", "395525", "respond", "2938" )' aria-label="Reply to Mazhar Ali">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-395791" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-395791" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 9, 2017 at 2:38 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-395791" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I only have tutorials for Keras:<br>
<a href="http://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">http://machinelearningmastery.com/start-here/#deeplearning</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=395791#respond" onclick='return addComment.moveForm( "comment-395791", "395791", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-395550" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-395550" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/9924ec5166c8d804ec025d92d3db01c7.jpeg" srcset="http://0.gravatar.com/avatar/9924ec5166c8d804ec025d92d3db01c7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ady</span>
	                <span class="date">April 7, 2017 at 12:52 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-395550" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your friendly explanation.<br>
I bought a lot of help from your books. </p>
<p>Are you willing to add examples of fit_generator and batch normalization to the IMDB LSTM example? </p>
<p>I was told to use the fit_generator function to process large amounts of data.<br>
If there is an example, it will be very helpful to book buyers.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=395550#respond" onclick='return addComment.moveForm( "comment-395550", "395550", "respond", "2938" )' aria-label="Reply to Ady">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-395803" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-395803" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 9, 2017 at 2:44 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-395803" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would like to add this kind of example in the future. Thanks for the suggestion.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=395803#respond" onclick='return addComment.moveForm( "comment-395803", "395803", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-395642" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-395642" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/3e7670f99caf88a98f45853147678fee.jpeg" srcset="http://0.gravatar.com/avatar/3e7670f99caf88a98f45853147678fee?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fernando López</span>
	                <span class="date">April 8, 2017 at 4:31 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-395642" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>I would like to know where I can read more about dropout and 
recurrent_dropout. Do you know some paper or something to explore it?</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=395642#respond" onclick='return addComment.moveForm( "comment-395642", "395642", "respond", "2938" )' aria-label="Reply to Fernando López">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-395821" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-395821" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 9, 2017 at 2:56 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-395821" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have a tutorial on dropout here:<br>
<a href="http://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/" rel="nofollow">http://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/</a></p>
<p>I have a post on recurrent dropout scheduled for the blog soon.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=395821#respond" onclick='return addComment.moveForm( "comment-395821", "395821", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-396361" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-396361" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/d57ffba71bc818b2102fa81b36980ab6.jpeg" srcset="http://1.gravatar.com/avatar/d57ffba71bc818b2102fa81b36980ab6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Donato Tiano</span>
	                <span class="date">April 14, 2017 at 1:14 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-396361" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I’ve a problem with the shape of my dataset</p>
<p>x_train = numpy.random.random((100, 3))<br>
y_train = uti.to_categorical(numpy.random.randint(10, size=(100, 1)), num_classes=10)<br>
model = Sequential()<br>
model.add(Conv1D(2,2,activation=’relu’,input_shape=x_train.shape))<br>
model.compile(loss=’binary_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br>
model.fit(x_train,y_train, epochs=150)</p>
<p>I have tried to create random a dataset, and pass at CNN with 1D, but
 I don’t know why, the Conv1D accepts my shape (I think that put 
automaticly the value None), but the fit doesn’t accept (I think becaus 
the Conv1D have accepted 3 dimension). I have this error:</p>
<p>ValueError: Error when checking model input: expected conv1d_1_input to have 3 dimensions, but got array with shape (100, 3)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=396361#respond" onclick='return addComment.moveForm( "comment-396361", "396361", "respond", "2938" )' aria-label="Reply to Donato Tiano">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-396393" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-396393" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 14, 2017 at 8:47 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-396393" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Your input data must be 3d, even if one or two of those dimensions have a width of 1.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=396393#respond" onclick='return addComment.moveForm( "comment-396393", "396393", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-396608" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-396608" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/c664064305c64148b04e757ed0e0020e.jpeg" srcset="http://0.gravatar.com/avatar/c664064305c64148b04e757ed0e0020e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Len</span>
	                <span class="date">April 16, 2017 at 1:24 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-396608" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Thanks for an awesome article!</p>
<p>I wanted to ask for some suggestions on training my data set. The 
data I have are 1d measurements taken at a time with a binary label for 
each instance. </p>
<p>Thanks to your blogs I successfully have built a LSTM and it does a 
great job at classifying the dominant class. The main issue is that the 
proportion of 0s to 1s is very high. There are about .03 the number of 
1s as there are 0s. For the most part, the 1s occur when there are high 
values of these measurements. So, I figured I could get a LSTM model to 
make better predictions if a model could see the last “p” measurements. 
Intuitively, it would recognize an abnormal increase in the measurement 
and associate that behavior with a output of 1. </p>
<p>Knowing some of this basic basckground could you suggest a structure that may<br>
1.) help exploit the structure of abnormally high measurement with outputs of 1<br>
2.) help with the low exposure to 1 instances</p>
<p>Thanks for any help or references!</p>
<p>cheers!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=396608#respond" onclick='return addComment.moveForm( "comment-396608", "396608", "respond", "2938" )' aria-label="Reply to Len">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-396654" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-396654" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 17, 2017 at 5:08 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-396654" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Len,</p>
<p>Perhaps you can use some of the resampling methods used for imbalanced datasets:<br>
<a href="http://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/" rel="nofollow">http://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=396654#respond" onclick='return addComment.moveForm( "comment-396654", "396654", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397498" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-397498" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/c9bef4a21610718405510937ec085411.jpeg" srcset="http://0.gravatar.com/avatar/c9bef4a21610718405510937ec085411?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">m91</span>
	                <span class="date">April 25, 2017 at 1:29 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-397498" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, that’s a great tutorial!<br>
Just wondering: as you are paddin with zeros, why aren’t you setting the Embedding layer flag mask_zero to True?<br>
Without doing that, the padded symbols will influence the computation of the cost function, isn’t it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=397498#respond" onclick='return addComment.moveForm( "comment-397498", "397498", "respond", "2938" )' aria-label="Reply to m91">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397530" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-397530" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 25, 2017 at 7:50 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-397530" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That is a good suggestion. Perhaps that flag did not exist when I write the example.</p>
<p>If you see a benefit, let me know.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=397530#respond" onclick='return addComment.moveForm( "comment-397530", "397530", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397755" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-397755" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/5aa22094225696627fdb1f29ed751694.jpeg" srcset="http://2.gravatar.com/avatar/5aa22094225696627fdb1f29ed751694?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.linkedin.com/in/saurabh-nair-31a13877/" rel="external nofollow" class="url">Saurabh Nair</a></span>
	                <span class="date">April 27, 2017 at 11:44 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-397755" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Great tutorial! Helped a lot.<br>
I’ve got a theoretical question though. Is sequence classification just 
based on the last state of the LSTM or do you have to take the dense 
layer for all the hidden units(100 LSTM in this case). Is sequence 
classification possible just based on the last state? Most of the 
implementations I see, there is dense and a softmax to classify the 
sequence.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=397755#respond" onclick='return addComment.moveForm( "comment-397755", "397755", "respond", "2938" )' aria-label="Reply to Saurabh Nair">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397835" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-397835" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 28, 2017 at 7:27 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-397835" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We do need the dense layer to interpret what the LSTMs have learned.</p>
<p>The LSTMs are modeling the problem as a function of the input time steps and of the internal state.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=397835#respond" onclick='return addComment.moveForm( "comment-397835", "397835", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397759" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-397759" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/dbc112a220b4c0d6f974b07f7e032ff9.jpeg" srcset="http://1.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">nguyennguyen</span>
	                <span class="date">April 27, 2017 at 12:22 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-397759" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Can you tell me about time_step in LSTM?, with example or something to 
easy understand. If   my data have 2 dimension, [[1,2]…[1,3]] ouput: 
[1,…0], so with keras, LSTM layer need 3 dimension, so i just can 
reshape input data to 3 dimension with time_step =1, can train it like 
this?, with time_step&gt; 1 is it better, i want to know mean of 
time_step in LSTM, thank you so much for read my question.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=397759#respond" onclick='return addComment.moveForm( "comment-397759", "397759", "respond", "2938" )' aria-label="Reply to nguyennguyen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397837" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-397837" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 28, 2017 at 7:29 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-397837" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can, but it is better to provide the sequence information in the time step.</p>
<p>The LSTM is developing a function of observations over prior time steps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=397837#respond" onclick='return addComment.moveForm( "comment-397837", "397837", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-398626" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-398626" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/39da563bc91cc9c97d737f218376c64e.jpeg" srcset="http://0.gravatar.com/avatar/39da563bc91cc9c97d737f218376c64e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Carlos de Sá</span>
	                <span class="date">May 5, 2017 at 2:42 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-398626" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
First of ali, thank you for your great explanation.<br>
I am considering setting up an aws g2.2xlarge instance according to  
your explanation in another post . Would you have  some benchmark (ex: 
time of 1 epoch of one of the above examples) so that I can compre with 
my current hardware?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=398626#respond" onclick='return addComment.moveForm( "comment-398626", "398626", "respond", "2938" )' aria-label="Reply to Carlos de Sá">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-398731" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-398731" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 6, 2017 at 7:34 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-398731" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have any execution time benchmarks.</p>
<p>I generally see great benefit from large AWS instances in terms 
getting access to a lot more memory (larger datasets) when using LSTMs. </p>
<p> I see a lot more benefit running CNNs on GPUs than LSTMs on GPUs.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=398731#respond" onclick='return addComment.moveForm( "comment-398731", "398731", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-398638" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-398638" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/f29dc041e5417e3773f616e479af736e.jpeg" srcset="http://0.gravatar.com/avatar/f29dc041e5417e3773f616e479af736e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Iris L</span>
	                <span class="date">May 5, 2017 at 4:41 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-398638" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I am also curious in the problem of padding. I think pad_sequence is 
the way to obtain fixed length of sequences. However, instead of padding
 zeros, can we actually scale the data?</p>
<p>Then, the problem is 1) if scaling sequences will distort the meaning
 of sentences given that sentences are represented as sequences and 2) 
how to choose a good scale factor. </p>
<p>Thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=398638#respond" onclick='return addComment.moveForm( "comment-398638", "398638", "respond", "2938" )' aria-label="Reply to Iris L">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-398733" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-398733" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 6, 2017 at 7:38 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-398733" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question.</p>
<p>Generally, a good way to reduce the length of sequences of words is 
first remove the low frequency words, then truncate the sequence to a 
desired length or pad out to the length.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=398733#respond" onclick='return addComment.moveForm( "comment-398733", "398733", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-399517" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-399517" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/6cc0059e7264ec1a65e56a360de273ea.jpeg" srcset="http://0.gravatar.com/avatar/6cc0059e7264ec1a65e56a360de273ea?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chao</span>
	                <span class="date">May 13, 2017 at 2:42 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-399517" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>For using LSTM, why we still need to scale the input sequence to 
the fixed size? Why not build some model like seq2seq just multi-input 
to one-output</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=399517#respond" onclick='return addComment.moveForm( "comment-399517", "399517", "respond", "2938" )' aria-label="Reply to Chao">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-399536" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-399536" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 13, 2017 at 6:16 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-399536" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Even with seq2seq, you must vectorize your input data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=399536#respond" onclick='return addComment.moveForm( "comment-399536", "399536", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-399519" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-399519" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/6cc0059e7264ec1a65e56a360de273ea.jpeg" srcset="http://0.gravatar.com/avatar/6cc0059e7264ec1a65e56a360de273ea?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chao</span>
	                <span class="date">May 13, 2017 at 2:58 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-399519" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I saw the data loaded from IMDB, which has already be encoded as numbers.<br>
Why do we need another Embedding layer to encoding?</p>
<p>(X_train, y_train), (X_test, y_test) = imdb.load_data(num_words=top_words)<br>
print X_train[1]<br>
The output is<br>
[1, 194, 1153, 194, 2, 78, 228, 5, 6, 1463, 4369,…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=399519#respond" onclick='return addComment.moveForm( "comment-399519", "399519", "respond", "2938" )' aria-label="Reply to Chao">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-399537" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-399537" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 13, 2017 at 6:17 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-399537" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The embedding is a more expressive representation which results in better performance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=399537#respond" onclick='return addComment.moveForm( "comment-399537", "399537", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-399907" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-399907" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/4870ea09325f0cde83c4973d3d33d7b5.jpeg" srcset="http://1.gravatar.com/avatar/4870ea09325f0cde83c4973d3d33d7b5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amir</span>
	                <span class="date">May 18, 2017 at 1:45 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-399907" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason for your article and answering comments also. Can I 
use this approach to solve my issue described in this stack-overflow 
question? Please take a look at that.</p>
<p><a href="http://stackoverflow.com/questions/43987060/pattern-recognition-or-named-entity-recognition-for-information-extraction-in-nl/43991328#43991328" rel="nofollow">http://stackoverflow.com/questions/43987060/pattern-recognition-or-named-entity-recognition-for-information-extraction-in-nl/43991328#43991328</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=399907#respond" onclick='return addComment.moveForm( "comment-399907", "399907", "respond", "2938" )' aria-label="Reply to Amir">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-399936" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-399936" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 18, 2017 at 8:39 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-399936" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps, I would recommend finding some existing research to template a solution.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=399936#respond" onclick='return addComment.moveForm( "comment-399936", "399936", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400058" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-400058" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/9ff1bc71820228d52c4398f24bc8cacb.jpeg" srcset="http://0.gravatar.com/avatar/9ff1bc71820228d52c4398f24bc8cacb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">vijay</span>
	                <span class="date">May 19, 2017 at 10:34 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-400058" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason for your article. I have implemented a CNN followed 
by LSTM neural network model in keras for sentence classification. But 
after 1 or 2 epoch my training accuracy and validation accuracy stuck to
 some number and do not change. Like it has stuck in some local minima 
or some other reason. What should i do to resolve this problem. If i use
 only CNN in my model then both training and validation accuracy 
converges to good accuracy. Can you help me in this. I couldn’t identify
 the problem.</p>
<p>Here is the training and validation accuracy.</p>
<p>Epoch 1/20<br>
1472/1500 [============================&gt;.] -8s – loss: 0.5327 – acc: 0.8516 – val_loss: 0.3925 – val_acc: 0.8460<br>
Epoch 2/20<br>
1500/1500 [==============================] – 10s – loss: 0.3733 – acc: 0.8531 – val_loss: 0.3755 – val_acc: 0.8460<br>
Epoch 3/20<br>
1500/1500 [==============================] – 8s – loss: 0.3695 – acc: 0.8529 – val_loss: 0.3764 – val_acc: 0.8460<br>
Epoch 4/20<br>
1500/1500 [==============================] – 8s – loss: 0.3700 – acc: 0.8531 – val_loss: 0.3752 – val_acc: 0.8460<br>
Epoch 5/20<br>
1500/1500 [==============================] – 8s – loss: 0.3706 – acc: 0.8528 – val_loss: 0.3763 – val_acc: 0.8460<br>
Epoch 6/20<br>
1500/1500 [==============================] – 8s – loss: 0.3703 – acc: 0.8528 – val_loss: 0.3760 – val_acc: 0.8460<br>
Epoch 7/20<br>
1500/1500 [==============================] – 8s – loss: 0.3700 – acc: 0.8528 – val_loss: 0.3764 – val_acc: 0.8460<br>
Epoch 8/20<br>
1500/1500 [==============================] – 8s – loss: 0.3697 – acc: 0.8531 – val_loss: 0.3752 – val_acc: 0.8460<br>
Epoch 9/20<br>
1500/1500 [==============================] – 8s – loss: 0.3708 – acc: 0.8530 – val_loss: 0.3758 – val_acc: 0.8460<br>
Epoch 10/20<br>
1500/1500 [==============================] – 8s – loss: 0.3703 – acc: 0.8527 – val_loss: 0.3760 – val_acc: 0.8460<br>
Epoch 11/20<br>
1500/1500 [==============================] – 8s – loss: 0.3698 – acc: 0.8531 – val_loss: 0.3753 – val_acc: 0.8460<br>
Epoch 12/20<br>
1500/1500 [==============================] – 8s – loss: 0.3699 – acc: 0.8531 – val_loss: 0.3758 – val_acc: 0.8460<br>
Epoch 13/20<br>
1500/1500 [==============================] – 8s – loss: 0.3698 – acc: 0.8531 – val_loss: 0.3753 – val_acc: 0.8460<br>
Epoch 14/20<br>
1500/1500 [==============================] – 10s – loss: 0.3700 – acc: 0.8533 – val_loss: 0.3769 – val_acc: 0.8460<br>
Epoch 15/20<br>
1500/1500 [==============================] – 9s – loss: 0.3704 – acc: 0.8532 – val_loss: 0.3768 – val_acc: 0.8460<br>
Epoch 16/20<br>
1500/1500 [==============================] – 8s – loss: 0.3699 – acc: 0.8531 – val_loss: 0.3756 – val_acc: 0.8460<br>
Epoch 17/20<br>
1500/1500 [==============================] – 8s – loss: 0.3699 – acc: 0.8531 – val_loss: 0.3753 – val_acc: 0.8460<br>
Epoch 18/20<br>
1500/1500 [==============================] – 8s – loss: 0.3696 – acc: 0.8531 – val_loss: 0.3753 – val_acc: 0.8460<br>
Epoch 19/20<br>
1500/1500 [==============================] – 8s – loss: 0.3696 – acc: 0.8531 – val_loss: 0.3757 – val_acc: 0.8460<br>
Epoch 20/20<br>
1500/1500 [==============================] – 8s – loss: 0.3701 – acc: 0.8531 – val_loss: 0.3754 – val_acc: 0.8460</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=400058#respond" onclick='return addComment.moveForm( "comment-400058", "400058", "respond", "2938" )' aria-label="Reply to vijay">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-400093" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-400093" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 20, 2017 at 5:38 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-400093" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I provide a list of ideas here to help you improve the performance on your deep learning projects:<br>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=400093#respond" onclick='return addComment.moveForm( "comment-400093", "400093", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400219" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-400219" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/f9fa0cd1080b9eb9185092106a1d2e36.jpeg" srcset="http://0.gravatar.com/avatar/f9fa0cd1080b9eb9185092106a1d2e36?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Libardo</span>
	                <span class="date">May 22, 2017 at 2:38 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-400219" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, thaks for yor great post.<br>
I am beginner with DL.<br>
If I need to include some behavioral features to this analysis, let say:
 age, genre, zipcode, time (DD:HH), season 
(spring/summer/autumn/winter)… could you give me some hints to implement
 that?</p>
<p>TIA</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=400219#respond" onclick='return addComment.moveForm( "comment-400219", "400219", "respond", "2938" )' aria-label="Reply to Libardo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-400238" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-400238" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 22, 2017 at 7:54 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-400238" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Each would be a different feature on the input data. </p>
<p>Remember, input data must be structured [samples, timesteps, features].</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=400238#respond" onclick='return addComment.moveForm( "comment-400238", "400238", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400732" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-400732" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/e53875e4916062c8c993c5de3a9bdf19.jpeg" srcset="http://2.gravatar.com/avatar/e53875e4916062c8c993c5de3a9bdf19?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kadir Habib</span>
	                <span class="date">May 29, 2017 at 2:32 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-400732" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br>
How can I use my own data, instead of IMDB for training?</p>
<p>Thanks<br>
Kadir</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=400732#respond" onclick='return addComment.moveForm( "comment-400732", "400732", "respond", "2938" )' aria-label="Reply to Kadir Habib">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401177" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-401177" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 2, 2017 at 12:20 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401177" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You will need to encode the text data as integers.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=401177#respond" onclick='return addComment.moveForm( "comment-401177", "401177", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400768" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-400768" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/7d687a8bdfae4f925dceed221e82b028.jpeg" srcset="http://1.gravatar.com/avatar/7d687a8bdfae4f925dceed221e82b028?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kunal chakraborty</span>
	                <span class="date">May 29, 2017 at 10:44 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-400768" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Dr.Jason,</p>
<p>I am very thankful for your blog-posts. They are undoubtedly one of the best on the internet.<br>
I have one doubt though. Why did you use the validation dataset as 
x_test and y_test in the very first example that you described. I just 
find it a little bit confusing.</p>
<p>Thanks in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=400768#respond" onclick='return addComment.moveForm( "comment-400768", "400768", "respond", "2938" )' aria-label="Reply to Kunal chakraborty">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401187" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-401187" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 2, 2017 at 12:27 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401187" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>I did it to give an idea of skill of the model as it was being fit. You do not need to do this.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=401187#respond" onclick='return addComment.moveForm( "comment-401187", "401187", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400904" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-400904" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/e9102dab9c84e3792323e876d0be805b.jpeg" srcset="http://2.gravatar.com/avatar/e9102dab9c84e3792323e876d0be805b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://solutionhacker.com/" rel="external nofollow" class="url">ray</a></span>
	                <span class="date">May 31, 2017 at 2:33 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-400904" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>i added dropout on CNN+RNN like you said and it gives me 87.65% 
accuracy. I still not clear the purpose of combining both as i thought 
CNN is for 2D+ input like image or video. But anyway, your tutorial 
gives me a great starting point to dive into RNN. Many thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=400904#respond" onclick='return addComment.moveForm( "comment-400904", "400904", "respond", "2938" )' aria-label="Reply to ray">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401213" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-401213" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 2, 2017 at 12:43 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401213" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=401213#respond" onclick='return addComment.moveForm( "comment-401213", "401213", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-401358" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-401358" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/5c201783007b89f7b98f68a874fe70b1.jpeg" srcset="http://2.gravatar.com/avatar/5c201783007b89f7b98f68a874fe70b1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fred</span>
	                <span class="date">June 3, 2017 at 8:21 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401358" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the post.</p>
<p>If I am understanding right, after the embedding layer EACH SAMPLE 
(each review) in the training data is transformed into a 32 by 500 
matrix. When taking an analogy from audio spectrogram, it is a 32-dim 
spectrum with 500 time frames long.</p>
<p>With the equivalence or analogy above, I can perform audio waveform 
classification with audio raw spectrogram as the input and class labels 
(whatever it is, might be audio quality good or bad) in exact the same 
code in this post (except the embedding layer). Is it correct?</p>
<p>Furthermore, I am wondering about why should the length of the input 
be the same, i.e. 500 in the post. If I am doing in the context of 
online training, in which a single sample is fed into the model at a 
time (batch size is 1), there should be no concern about varying length 
of samples right? That is, each sample (of varying length without 
padding) and its target are used to train the model one after another, 
and there is no worry about the varying length. Is it just the issue of 
implementation in Keras, or in theory the input length of each sample 
should be the same?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=401358#respond" onclick='return addComment.moveForm( "comment-401358", "401358", "respond", "2938" )' aria-label="Reply to Fred">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401409" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-401409" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 4, 2017 at 7:51 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401409" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Fred,</p>
<p>Yes, try it.</p>
<p>The vectorized input requires all inputs to have the same length (for
 efficiencies in the backend libraries). You use zero-padding (and even 
masking) to meet this requirement.</p>
<p>The size parameters are fixed in the definition of the network I 
believe. You could do tricks from batch to batch re-defining+compiling 
your network as you go, but that would not be efficient.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=401409#respond" onclick='return addComment.moveForm( "comment-401409", "401409", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401422" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-401422" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/5c201783007b89f7b98f68a874fe70b1.jpeg" srcset="http://2.gravatar.com/avatar/5c201783007b89f7b98f68a874fe70b1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fred</span>
	                <span class="date">June 4, 2017 at 11:22 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401422" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your reply, I will try it.</p>
<p>I was just wondering if the RNN or LSTM in theory requires every input to be in a same length.<br>
As far as I know, one of the superiorities of RNN over DNN is that it accepts varying-length input. </p>
<p>It doesn’t bother me If the requirement is for efficiency issue in 
Keras, and the zero’s (if zero-padding is used) is regarded to carry 
zero information. In the audio spectrogram case, would you recommend 
zero-padding the raw waveform (one-D) or spectrogram (two-D)? With the 
analogy to your post, the choice would be the former though.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=401422#respond" onclick='return addComment.moveForm( "comment-401422", "401422", "respond", "2938" )' aria-label="Reply to Fred">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401515" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-401515" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 5, 2017 at 7:37 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401515" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Fred,</p>
<p>Padding is not required by LSTMs in theory, it is only a limitation 
of efficient implementations that require vectorized inputs. </p>
<p>A fair tradeoff for most applications perhaps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=401515#respond" onclick='return addComment.moveForm( "comment-401515", "401515", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-403093" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-403093" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/594938c71a5c9cdd872da23a6edc3857.jpeg" srcset="http://2.gravatar.com/avatar/594938c71a5c9cdd872da23a6edc3857?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">adit agrawal</span>
	                <span class="date">June 20, 2017 at 3:29 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-403093" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Is there a way in RNN (keras implementation) to control for the attention of the LSTM.<br>
I have a dataset where 100 time series inputs are fed as sequence. I 
want the LSTM to give more importance to the last 10 time series inputs.<br>
Can it be done?</p>
<p>Thanks in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=403093#respond" onclick='return addComment.moveForm( "comment-403093", "403093", "respond", "2938" )' aria-label="Reply to adit agrawal">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403133" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-403133" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 20, 2017 at 6:41 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-403133" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, but you must code a custom layer to do the attention.</p>
<p>I hope to cover attention models for LSTMs soon.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=403133#respond" onclick='return addComment.moveForm( "comment-403133", "403133", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-403426" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-403426" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1c79976ca30b944667ead8df59a63009.jpeg" srcset="http://1.gravatar.com/avatar/1c79976ca30b944667ead8df59a63009?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">vivz</span>
	                <span class="date">June 22, 2017 at 4:17 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-403426" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
After building and saving the model I want to use it for a prediction on
 new texts but I don’t know how to preprocess the plain text in order to
 use them for predictions. I have searched about it and find this way:<br>
text = np.array([‘this is a random sentence’])<br>
tk = keras.preprocessing.text.Tokenizer( nb_words=2000, lower=True,split=” “)<br>
predictions = loaded_model.predict(np.array(tk.fit_on_texts(text)))</p>
<p>but this is not working for me and showing this error:<br>
ValueError: Error when checking : expected embedding_1_input to have 2 dimensions, but got array with shape ()</p>
<p>Can You please tell me the proper way to preprocess the text. Any help is greatly appreciated.<br>
Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=403426#respond" onclick='return addComment.moveForm( "comment-403426", "403426", "respond", "2938" )' aria-label="Reply to vivz">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403495" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-403495" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 23, 2017 at 6:40 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-403495" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Generally, you need to integer encode the words.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=403495#respond" onclick='return addComment.moveForm( "comment-403495", "403495", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403569" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-403569" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1c79976ca30b944667ead8df59a63009.jpeg" srcset="http://1.gravatar.com/avatar/1c79976ca30b944667ead8df59a63009?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">vivz</span>
	                <span class="date">June 23, 2017 at 7:11 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-403569" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the reply<br>
I converted my string like this:<br>
text = ‘It is a good movie to watch’<br>
import keras.preprocessing.text<br>
text = keras.preprocessing.text.one_hot(text, 5000, lower=True, split=” “)<br>
text = [text]<br>
text = sequence.pad_sequences(text, 500)<br>
predictions = loaded_model.predict(text)</p>
<p>But got the output as: [[ 0.10996077]]<br>
Shouldn’t it be close to 1?<br>
Many Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=403569#respond" onclick='return addComment.moveForm( "comment-403569", "403569", "respond", "2938" )' aria-label="Reply to vivz">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403647" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-403647" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 24, 2017 at 8:05 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-403647" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t follow. Why do you expect te output to be 1? What are you predicting?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=403647#respond" onclick='return addComment.moveForm( "comment-403647", "403647", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403878" class="comment odd alt depth-5">

	      	<div id="li-comment-403878" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1c79976ca30b944667ead8df59a63009.jpeg" srcset="http://1.gravatar.com/avatar/1c79976ca30b944667ead8df59a63009?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vivek Vishnoi</span>
	                <span class="date">June 26, 2017 at 9:00 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-403878" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What I interpret is that 1 is the label for positive sentiment 
and since I am using a positive statement to predict I am expecting 
output to be 1.<br>
I had made a mistake in the last comment by using model.predict() to get
 class labels, the correct way to get the label is 
model.predict_classes() but still, it’s not giving proper class labels.<br>
So my question is whether I made a mistake in converting text into one-hot vector or is it the right way to do it.<br>
Many Thanks</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-403940" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-403940" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 27, 2017 at 8:29 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-403940" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>As long as you are consistent in data preparation and in interpretation at the other end, then you should be fine.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-404242" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-404242" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/4b6dc97f485d7721e4d3b31929a2ca62.jpeg" srcset="http://1.gravatar.com/avatar/4b6dc97f485d7721e4d3b31929a2ca62?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sk</span>
	                <span class="date">June 29, 2017 at 4:30 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-404242" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can you do a tutorial for preprocessing text dataset and then passing them as input using word embeddings? Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=404242#respond" onclick='return addComment.moveForm( "comment-404242", "404242", "respond", "2938" )' aria-label="Reply to sk">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-404302" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-404302" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 30, 2017 at 8:08 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-404302" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great suggestion. It is high on my list!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=404302#respond" onclick='return addComment.moveForm( "comment-404302", "404302", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-404361" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-404361" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/6354b4cf65c74a90b4a6984a9b0cc396.jpeg" srcset="http://0.gravatar.com/avatar/6354b4cf65c74a90b4a6984a9b0cc396?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">tanmay</span>
	                <span class="date">June 30, 2017 at 9:02 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-404361" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can we use sequence labelling problem over continous variable. I 
have datasets of customer paying their debt within due date, buffer 
period and beyond buffer period. Basis on this I want to score the 
customer from good to bad. Is it posible using sequence labelling.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=404361#respond" onclick='return addComment.moveForm( "comment-404361", "404361", "respond", "2938" )' aria-label="Reply to tanmay">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-404415" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-404415" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 1, 2017 at 6:34 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-404415" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps, I’m not sure I understand your dataset. Can you give a one-case example?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=404415#respond" onclick='return addComment.moveForm( "comment-404415", "404415", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-404676" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-404676" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/8b601a43c4c6a2b59576fec138f18959.jpeg" srcset="http://2.gravatar.com/avatar/8b601a43c4c6a2b59576fec138f18959?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Karthik Suresh</span>
	                <span class="date">July 4, 2017 at 7:53 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-404676" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, great tutorial! </p>
<p>I have data as follows</p>
<p>Text 	   Alpha-Numeric 	     Label<br>
“foo”	        A1034            	         A<br>
“bar”   	A1234        	         B</p>
<p>I have already mapped an LSTM model from Text column to label column.
 However, I need to add the Alpha-numeric Column with the Text as an 
additional feature to my LSTM model. How can I do that in Keras?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=404676#respond" onclick='return addComment.moveForm( "comment-404676", "404676", "respond", "2938" )' aria-label="Reply to Karthik Suresh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-404876" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-404876" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 6, 2017 at 10:06 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-404876" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Consider a one hot encoding.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=404876#respond" onclick='return addComment.moveForm( "comment-404876", "404876", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-404743" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-404743" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1906836624053a3ea7d8d995cc58940b.jpeg" srcset="http://1.gravatar.com/avatar/1906836624053a3ea7d8d995cc58940b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sajad</span>
	                <span class="date">July 5, 2017 at 12:32 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-404743" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, it was really great and I am happy that this tutorial was my 
first practical project in LSTM. I need to have f-measures, False 
Positives and AUC instead of “accuracy” in your code. Do you have any 
idea how to get them? </p>
<p>Thank you in advance.<br>
Sajad,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=404743#respond" onclick='return addComment.moveForm( "comment-404743", "404743", "respond", "2938" )' aria-label="Reply to Sajad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-404894" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-404894" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 6, 2017 at 10:20 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-404894" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can make predictions, then use the array of predictions and expected value to calculate these scores using sklearn:<br>
<a href="http://scikit-learn.org/stable/modules/classes.html#sklearn-metrics-metrics" rel="nofollow">http://scikit-learn.org/stable/modules/classes.html#sklearn-metrics-metrics</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=404894#respond" onclick='return addComment.moveForm( "comment-404894", "404894", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-405362" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-405362" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/11387f8dbbbf7cd60dfcb314b6aa39b4.jpeg" srcset="http://1.gravatar.com/avatar/11387f8dbbbf7cd60dfcb314b6aa39b4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Reihaneh</span>
	                <span class="date">July 10, 2017 at 10:24 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405362" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have a question about built-in embedding layer in Keras.<br>
I have done word embedding with word2vec model which is working based on
 the semantic similarity of the words–those in the same context are more
 similar.  I am wondering whether Keras embedding layer is also 
following the w2v model or it has its own algorithm to map the words 
into vectors?<br>
Based on what semantics it map the words to vectors?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=405362#respond" onclick='return addComment.moveForm( "comment-405362", "405362", "respond", "2938" )' aria-label="Reply to Reihaneh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405472" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-405472" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 11, 2017 at 10:26 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405472" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question, there’s a bit more on it here:<br>
<a href="https://keras.io/layers/embeddings/" rel="nofollow">https://keras.io/layers/embeddings/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=405472#respond" onclick='return addComment.moveForm( "comment-405472", "405472", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405563" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-405563" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/11387f8dbbbf7cd60dfcb314b6aa39b4.jpeg" srcset="http://1.gravatar.com/avatar/11387f8dbbbf7cd60dfcb314b6aa39b4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Reihaneh</span>
	                <span class="date">July 12, 2017 at 3:09 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405563" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason!<br>
I went through most of the documentations about this but none of them 
mention about the semantic behind this biult-in word embedding process.</p>
<p>I would like to know it because right now I keep thinking that the 
process inside this method is possibly causing the low accuracy! </p>
<p>Please keep me posted if you find anything about it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=405563#respond" onclick='return addComment.moveForm( "comment-405563", "405563", "respond", "2938" )' aria-label="Reply to Reihaneh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405608" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-405608" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 12, 2017 at 9:51 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405608" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend reading the code here:<br>
<a href="https://github.com/fchollet/keras/blob/master/keras/layers/embeddings.py#L11" rel="nofollow">https://github.com/fchollet/keras/blob/master/keras/layers/embeddings.py#L11</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=405608#respond" onclick='return addComment.moveForm( "comment-405608", "405608", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-405499" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-405499" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/e4ebfc52ba9013da1768bc730037d966.jpeg" srcset="http://2.gravatar.com/avatar/e4ebfc52ba9013da1768bc730037d966?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">William Wong</span>
	                <span class="date">July 11, 2017 at 12:03 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405499" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Excellent article.  I am trying to use CNN to model time series data and
 feed into LSTM for supervised learning.  I have a 2d matrix with 
columns representing previous n-time steps and rows representing the 
different price levels each time steps visited:<br>
Price   Bar0   Bar1   Bar2   Bar3   Bar4   Bar5  …<br>
0         0          0         1        1         0        0<br>
1         1          0         1        1         0        1<br>
2         1          1         1        1         1        1<br>
3         1          1         0        1         1        0<br>
4         0          0         0        0         1        0<br>
…<br>
this matrix will represent, price data of:<br>
       High    Low<br>
Bar0    3       1<br>
Bar1    3       2<br>
Bar2    2       0<br>
Bar3    3       0<br>
Bar4    4       2<br>
Bar5    2       1</p>
<p>Could you tell me how to adapt your 1-d CNN to 2-d CNN?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=405499#respond" onclick='return addComment.moveForm( "comment-405499", "405499", "respond", "2938" )' aria-label="Reply to William Wong">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-405505" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-405505" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/dbc112a220b4c0d6f974b07f7e032ff9.jpeg" srcset="http://1.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">truongtrang</span>
	                <span class="date">July 11, 2017 at 12:56 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405505" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi Jason,<br>
Great post for me.<br>
But I want to ask you about: length vector in Embedded layer, you said 
“the first layer is the Embedded layer that uses 32 length vectors to 
represent each word” , why you choose 32 instead of another number like 
64 or 128, Can you give me some best practice, or reason for your 
choose.<br>
Thanks you so much.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=405505#respond" onclick='return addComment.moveForm( "comment-405505", "405505", "respond", "2938" )' aria-label="Reply to truongtrang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405591" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-405591" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 12, 2017 at 9:39 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405591" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Trial and error. You could experiment with other representations and see what works best for your problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=405591#respond" onclick='return addComment.moveForm( "comment-405591", "405591", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405623" class="comment even depth-3 parent">

	      	<div id="li-comment-405623" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/dbc112a220b4c0d6f974b07f7e032ff9.jpeg" srcset="http://1.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">truongtrang</span>
	                <span class="date">July 12, 2017 at 11:20 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405623" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=405623#respond" onclick='return addComment.moveForm( "comment-405623", "405623", "respond", "2938" )' aria-label="Reply to truongtrang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405715" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-405715" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 13, 2017 at 9:47 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405715" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=405715#respond" onclick='return addComment.moveForm( "comment-405715", "405715", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-406405" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-406405" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/fd033c5cbf5be2d582e8a01aed939d98.jpeg" srcset="http://0.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tursun</span>
	                <span class="date">July 19, 2017 at 3:08 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-406405" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>@Jason,<br>
“Sequence classification is a predictive modeling problem where you have
 some sequence of inputs over space or time and the task is to predict a
 category for the sequence.”<br>
this is inspiring. I am thinking about to use sequence classification to IRIS dataset.<br>
Do you think it works ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=406405#respond" onclick='return addComment.moveForm( "comment-406405", "406405", "respond", "2938" )' aria-label="Reply to Tursun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-406446" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-406446" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 19, 2017 at 8:29 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-406446" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The iris flowers dataset is not a sequence classification problem. It is just a classification problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=406446#respond" onclick='return addComment.moveForm( "comment-406446", "406446", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-406505" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-406505" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/fd033c5cbf5be2d582e8a01aed939d98.jpeg" srcset="http://0.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tursun</span>
	                <span class="date">July 19, 2017 at 6:44 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-406505" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>@Jason,<br>
Do you mean that:<br>
I can not use LSTM for IRIS classification? I am working on IRIS like 
dataset. So I m exploring all possible classifiers. You have one here in
 your website. Besides,<br>
I have tried RBM in SKLearn, it did not work as my inputs are not binary
 inputs like MNIST dataset (even after SKLearn’s  
preprocessing.binarizer() function). I think they were wrong to say that
 RBM In SKLearn works for data in range of [0,1], it only works for 0 
and 1.<br>
(by the way I send you my code to  for reference)</p>
<p>I also have tried probablistic neural net (PNN), which yields only 
78% accuracy, low and no way to increase layers of PNN as it is single 
layer net (from Neupy).<br>
Now I came to RNN, but you said that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=406505#respond" onclick='return addComment.moveForm( "comment-406505", "406505", "respond", "2938" )' aria-label="Reply to Tursun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-406549" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-406549" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 20, 2017 at 6:19 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-406549" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, the iris dataset is not a sequence classification problem and the LSTM would be a bad fit.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=406549#respond" onclick='return addComment.moveForm( "comment-406549", "406549", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-406599" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-406599" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/fd033c5cbf5be2d582e8a01aed939d98.jpeg" srcset="http://0.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tursun</span>
	                <span class="date">July 20, 2017 at 2:34 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-406599" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>@Jason,<br>
What would you suggest ? I need your expert advice.<br>
I tried RBM in sklearn, it did not work.<br>
You said ,RNN would not work for it.<br>
I think, CNN clearly does not work for it.<br>
Do DBN and VAE left?</p>
<p>I wish to classify IRIS in 3 different ways. I did one only.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=406599#respond" onclick='return addComment.moveForm( "comment-406599", "406599", "respond", "2938" )' aria-label="Reply to Tursun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-406708" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-406708" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 21, 2017 at 9:29 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-406708" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Consider SVM, CART, and kNN.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=406708#respond" onclick='return addComment.moveForm( "comment-406708", "406708", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-407133" class="comment even depth-3 parent">

	      	<div id="li-comment-407133" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/fd033c5cbf5be2d582e8a01aed939d98.jpeg" srcset="http://0.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tursun</span>
	                <span class="date">July 24, 2017 at 3:58 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-407133" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>@Jason,<br>
Thank you. I’ve already tried kNN and SVM . There were good, gave good results.<br>
I have a feeling that Deep Learning methods yields even better results 
to my dataset. Do you have other suggessions in Deep Learning! this is 
my dataset:<br>
<a href="https://www.dropbox.com/s/4xsshq7nnlhd31h/P7_all_Data.csv?dl=0" rel="nofollow">https://www.dropbox.com/s/4xsshq7nnlhd31h/P7_all_Data.csv?dl=0</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=407133#respond" onclick='return addComment.moveForm( "comment-407133", "407133", "respond", "2938" )' aria-label="Reply to Tursun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-407216" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-407216" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 25, 2017 at 9:33 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-407216" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You could try a multilayer perceptron neural network.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=407216#respond" onclick='return addComment.moveForm( "comment-407216", "407216", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-407282" class="comment even depth-5">

	      	<div id="li-comment-407282" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/fd033c5cbf5be2d582e8a01aed939d98.jpeg" srcset="http://0.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">tursun</span>
	                <span class="date">July 25, 2017 at 11:38 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-407282" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason,<br>
I did try multi-layer perceptron. Result was good.<br>
I want to use deep neural net of more than 3 layers.<br>
What do you think about convolutional neural network?<br>
I originally think it is impossible. But, now thinking about it again.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-407327" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-407327" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 26, 2017 at 7:57 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-407327" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can do what you wish. CNNs are designed for spatial input and the iris flower dataset does not have a spatial input.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-407681" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-407681" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/30c7447a3dfe064028290dcad6c3c011.jpeg" srcset="http://0.gravatar.com/avatar/30c7447a3dfe064028290dcad6c3c011?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zachary</span>
	                <span class="date">July 28, 2017 at 6:21 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-407681" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I want ask what is the use of Dropout, It makes the 
accuracy lower, so does this mean the dropout is bad for machine 
learning? thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=407681#respond" onclick='return addComment.moveForm( "comment-407681", "407681", "respond", "2938" )' aria-label="Reply to Zachary">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-407751" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-407751" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 29, 2017 at 8:10 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-407751" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dropout can improve the performance of the model on some problems.</p>
<p>See this post on dropout:<br>
<a href="http://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/" rel="nofollow">http://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=407751#respond" onclick='return addComment.moveForm( "comment-407751", "407751", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-408163" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-408163" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/dd2ee02eb3032a6d7c292b1e87e8c1fe.jpeg" srcset="http://1.gravatar.com/avatar/dd2ee02eb3032a6d7c292b1e87e8c1fe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Daniel</span>
	                <span class="date">August 1, 2017 at 10:52 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-408163" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason! Great Post <img draggable="false" class="emoji" alt="🙂" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1f642.svg"> Really helped me in my internship this summer. I just wanted to get your thoughts on a couple things.</p>
<p>1. I’ve trained with about 400k documents in total and I’m getting an
 accuracy of ~98%. I always get vary when my model does ‘too’ well. Is 
that a fair cause-effect due to the enormous dataset ?</p>
<p>2. When I think of CNN’ing+max_pooling word vectors(Glove), I think 
of the operation basically meshing the word vectors for 3 words(possibly
 forming like a phrase representation).Am I right in my thought process ?</p>
<p>3. I’m still a little unclear on what the LSTM learns. I understand 
its not a typical seq-2-seq problem, so what do those 100 LSTM units 
hold ? </p>
<p>Thanks so much again for the great tutorial! <img draggable="false" class="emoji" alt="🙂" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1f642.svg"></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=408163#respond" onclick='return addComment.moveForm( "comment-408163", "408163", "respond", "2938" )' aria-label="Reply to Daniel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-408222" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-408222" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 2, 2017 at 7:53 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-408222" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad to hear that Daniel.</p>
<p>Maybe you want to test the model on a hold out set to see if the model skill is real or overfit.</p>
<p>Something like that, pooling does good nonlinear things that may not relate back to word vectors/words cleanly.</p>
<p>They hold a function of input and prior items in the input sequence. It’s complex for sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=408222#respond" onclick='return addComment.moveForm( "comment-408222", "408222", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-408844" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-408844" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/9bdc28bf0aa0ca6f80233c0c66f5cc97.jpeg" srcset="http://0.gravatar.com/avatar/9bdc28bf0aa0ca6f80233c0c66f5cc97?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amr</span>
	                <span class="date">August 7, 2017 at 7:52 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-408844" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>I wonder how 100 neurons in the LSTM layer would be able to accept 
the 500 vectors/words? I thought that the size of the LSTM layer should 
be equivalent to the length of the input sequence!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=408844#respond" onclick='return addComment.moveForm( "comment-408844", "408844", "respond", "2938" )' aria-label="Reply to Amr">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-408900" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-408900" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 8, 2017 at 7:47 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-408900" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, no the layers do not need to have the same number of units.</p>
<p>For example, If I had a vector of length 5 as input to a single 
neuron, then the neuron would have 5 weights, one for each element. We 
do not need 5 neurons for the 5 input elements (although we could), 
these concerns are separate and decoupled.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=408900#respond" onclick='return addComment.moveForm( "comment-408900", "408900", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-408924" class="comment even depth-3 parent">

	      	<div id="li-comment-408924" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/9bdc28bf0aa0ca6f80233c0c66f5cc97.jpeg" srcset="http://0.gravatar.com/avatar/9bdc28bf0aa0ca6f80233c0c66f5cc97?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amr</span>
	                <span class="date">August 8, 2017 at 9:55 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-408924" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your reply.<br>
But here we have already each input as a vector not a scalar! would that
 mean in this case that each neuron will receive 5 vectors each of them 
32 dimensional? so each neuron will have 5*32=160 weights? and if so, 
what is the advantage of that over having every neuron process only one 
word/vector?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=408924#respond" onclick='return addComment.moveForm( "comment-408924", "408924", "respond", "2938" )' aria-label="Reply to Amr">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-408954" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-408954" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 8, 2017 at 5:09 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-408954" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>For an MLP, word vectors are concatenated as you say and each neuron gets a lot of inputs.</p>
<p>LSTMs, on the other hand, treat each word as one input in a sequence and process them one at a time.</p>
<p>The idea is called “distributed representation” where all neurons get
 all inputs and they selectively learn different parts to focus on. </p>
<p>This is key to neural networks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=408954#respond" onclick='return addComment.moveForm( "comment-408954", "408954", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409409" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-409409" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1906836624053a3ea7d8d995cc58940b.jpeg" srcset="http://1.gravatar.com/avatar/1906836624053a3ea7d8d995cc58940b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sajad</span>
	                <span class="date">August 12, 2017 at 6:31 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-409409" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
consider we have 500 sequences with 100 elements in each sequence.<br>
if we do the embedding in a 32 dimensions vector, we will have a 100*32 matrix for each sequence.<br>
Now assume we are using only a layer of LSTM(20) in our project. I am a bit confused in practice:</p>
<p>I know that We have a hidden layer with 20 LSTM units in parallel. I 
want to know how Keras gives a sequence to the model. Does it give the 
same 32 dimension vectors to all LSTM units at a time in order and an 
iteration finishes at time [t+100]? (this way I think all units give the
 same (copy)  value after training, and it is equivalent to having only 
on unit), OR it gives 32dim vectors 20 by 20 to the the model in order 
and iteration ends at time [t+5]?</p>
<p>Thank you in advance,<br>
Sajad</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=409409#respond" onclick='return addComment.moveForm( "comment-409409", "409409", "respond", "2938" )' aria-label="Reply to Sajad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409464" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-409464" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 13, 2017 at 9:49 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-409464" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question.</p>
<p>So, the 100 time steps are passed as input to the model with 500 samples and 1 feature, something like [500, 100, 1]. </p>
<p>The Embedding will transform each time step into a 32 dimensional vector. </p>
<p>The LSTM will process the sequence one time step at a time, so one 32-dimensional embedding at a time. </p>
<p>Each memory cell will get the whole input. They all have a go at 
modeling the problem. An error propagated from deeper layers will 
encourage the hidden LSTM layer to learn the input sequence in a 
specific way, e.g. classify the sequence. Each cell will learn something
 slightly different.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=409464#respond" onclick='return addComment.moveForm( "comment-409464", "409464", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409599" class="comment even depth-3 parent">

	      	<div id="li-comment-409599" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1906836624053a3ea7d8d995cc58940b.jpeg" srcset="http://1.gravatar.com/avatar/1906836624053a3ea7d8d995cc58940b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sajad</span>
	                <span class="date">August 15, 2017 at 12:07 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-409599" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your clear answer.</p>
<p>1) I am working on malware detection using LSTM, so I have malware 
activities in a sequence. As another question, I want to know more about
 Embedding layer in Keras. In my project I have to convert elements into
 integer numbers to feed Embedding layer of Keras. I guess Embedding is a
 frozen neural network layer to convert elements of a sequence to a 
vector in a way that relations between different elements are 
meaningful, Right?  I would like to know if there is any logical issue 
of using Embedding in my project.</p>
<p>2) Do you know any references (book, paper, website etc.) for 
Embedding in Keras (academic/non-academic)? I need to draw a figure 
describing Embedding training network.</p>
<p>Thank you for your patience,</p>
<p>Sajad</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=409599#respond" onclick='return addComment.moveForm( "comment-409599", "409599", "respond", "2938" )' aria-label="Reply to Sajad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409636" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-409636" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 15, 2017 at 6:39 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-409636" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The Embedding has weights that are leared when you fit the model.</p>
<p>You can use pre-trained weights from a word2vec or glove run if you like. Learning custom weights for your task is often better.</p>
<p>I have a few posts scheduled on how the learned embedding layer 
works, that should be out next month. For now, this might be a good 
place for you to start:<br>
<a href="https://en.wikipedia.org/wiki/Word_embedding" rel="nofollow">https://en.wikipedia.org/wiki/Word_embedding</a></p>
<p>The Keras Embedding layer are just weights – vectors learned for each word in the input vocab. Very simple to describe.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=409636#respond" onclick='return addComment.moveForm( "comment-409636", "409636", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409719" class="comment even depth-5">

	      	<div id="li-comment-409719" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1906836624053a3ea7d8d995cc58940b.jpeg" srcset="http://1.gravatar.com/avatar/1906836624053a3ea7d8d995cc58940b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sajad</span>
	                <span class="date">August 15, 2017 at 11:16 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-409719" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason.<br>
That’s great, I am waiting for your posts on embedding.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-409756" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-409756" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 16, 2017 at 6:35 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-409756" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Sajad.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409724" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-409724" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/c7b425d7fbf2b07b8c44c46e66ccc079.jpeg" srcset="http://0.gravatar.com/avatar/c7b425d7fbf2b07b8c44c46e66ccc079?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Saho</span>
	                <span class="date">August 16, 2017 at 12:21 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-409724" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, this post was great for me.<br>
As a question I would like to know how to set the number of LSTM units in the hidden layer?</p>
<p>Is there any relationships between the number of samples (sequences) and the number of hidden units? </p>
<p>I have 400 sequences with 5000 element in each. How many LSTM units 
should I use? I know that I should test model with different number of 
hidden units but I am looking for an upperbound and lowerbound for 
number hidden units.</p>
<p>saho,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=409724#respond" onclick='return addComment.moveForm( "comment-409724", "409724", "respond", "2938" )' aria-label="Reply to Saho">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409759" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-409759" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 16, 2017 at 6:37 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-409759" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There is no analytical way to configure a neural network. I 
recommend trial and error, grid search, random search or copy 
configurations from other models.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=409759#respond" onclick='return addComment.moveForm( "comment-409759", "409759", "respond", "2938" )' aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410101" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-410101" class="comment-container">

					                <div class="avatar"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/31d9820d11de056cde81c4533dbfbc9a.jpeg" srcset="http://0.gravatar.com/avatar/31d9820d11de056cde81c4533dbfbc9a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Maddy</span>
	                <span class="date">August 18, 2017 at 5:17 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-410101" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>great work ! what if i want to apply this code on simple sentence
 sequence classification. how can we do that? how we are going to  
manipulate the data<br>
.</p>
<p>thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/?replytocom=410101#respond" onclick='return addComment.moveForm( "comment-410101", "410101", "respond", "2938" )' aria-label="Reply to Maddy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
			</ol>
		 	</div>	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#respond" style="display:none;">Click here to cancel reply.</a></small></h3>			<form action="http://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" method="post" id="commentform" class="comment-form">
				<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" class="txt" tabindex="1" size="30" aria-required="true" type="text"><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" class="txt" tabindex="2" size="30" aria-required="true" type="text"><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input id="url" name="url" class="txt" tabindex="3" size="30" type="text"><label for="url">Website</label></p>
<p class="form-submit"><input name="submit" id="submit" class="submit" value="Submit Comment" type="submit"> <input name="comment_post_ID" value="2938" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="fa8d28845e" type="hidden"></p><p style="display: none;"></p>			<input id="ak_js" name="ak_js" value="1503059149466" type="hidden"></form>
			</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/1d75d46040c28497f0dee5d8e100db37_002.jpeg" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" class="avatar avatar-100 photo" height="100" width="100"></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="http://machinelearningmastery.com/about">Read More</a></p>
<div class="fix"></div>
</div><div id="text-29" class="widget widget_text">			<div class="textwidget"><p></p><center><p></p>
<h3>Deep Learning for Sequence Prediction</h3>
<p>Cut through the math and research papers.<br>
Discover 4 Models, 6 Architectures, and 14 Tutorials.</p>
<p><a href="http://machinelearningmastery.com/lstms-with-python/">Get Started With LSTMs in Python Today!</a><br>
<a href="http://machinelearningmastery.com/lstms-with-python/"><img src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/Cover-220.png"></a><br>
</p></center><p></p>
</div>
		</div>
		<div id="woo_tabs-2" class="widget widget_woo_tabs"> 		<div id="tabs">

            <ul class="wooTabs">
                                <li class="popular"><a href="#tab-pop" class="selected">Popular</a></li>                                                            </ul>

            <div class="clear"></div>

            <div class="boxes box inside">

	            
                                <ul id="tab-pop" class="list" style="display: block;">
                    	<li>
		<a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-i.jpg" class="thumbnail wp-post-image" alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" height="45" width="45"></a>		<a title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
		<span class="meta">July 21, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="http://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-1.jpg" class="thumbnail wp-post-image" alt="Your First Machine Learning Project in Python Step-By-Step" title="Your First Machine Learning Project in Python Step-By-Step" height="45" width="45"></a>		<a title="Your First Machine Learning Project in Python Step-By-Step" href="http://machinelearningmastery.com/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python Step-By-Step</a>
		<span class="meta">June 10, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="http://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/Tour-of-Deep-Learning-Algorithms-150x150.jpg" class="thumbnail wp-post-image" alt="Tour of Deep Learning Algorithms" title="Develop Your First Neural Network in Python With Keras Step-By-Step" height="45" width="45"></a>		<a title="Develop Your First Neural Network in Python With Keras Step-By-Step" href="http://machinelearningmastery.com/tutorial-first-neural-network-python-keras/">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
		<span class="meta">May 24, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="http://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-D.png" class="thumbnail wp-post-image" alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" height="45" width="45"></a>		<a title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" href="http://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
		<span class="meta">March 13, 2017</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/Sequence-Classification-with-LSTM-Recurrent-Neural-Netwo_002.jpg" class="thumbnail wp-post-image" alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" height="45" width="45"></a>		<a title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
		<span class="meta">July 26, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="http://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Lear.jpg" class="thumbnail wp-post-image" alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" height="45" width="45"></a>		<a title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" href="http://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
		<span class="meta">June 2, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="http://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Pyth.jpg" class="thumbnail wp-post-image" alt="Regression Tutorial with Keras Deep Learning Library in Python" title="Regression Tutorial with the Keras Deep Learning Library in Python" height="45" width="45"></a>		<a title="Regression Tutorial with the Keras Deep Learning Library in Python" href="http://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/">Regression Tutorial with the Keras Deep Learning Library in Python</a>
		<span class="meta">June 9, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="http://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Netw.jpg" class="thumbnail wp-post-image" alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" title="Time Series Forecasting with the Long Short-Term Memory Network in Python" height="45" width="45"></a>		<a title="Time Series Forecasting with the Long Short-Term Memory Network in Python" href="http://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
		<span class="meta">April 7, 2017</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="http://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" title="How to Implement the Backpropagation Algorithm From Scratch In Python"><img src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-.jpg" class="thumbnail wp-post-image" alt="How to Implement the Backpropagation Algorithm From Scratch In Python" title="How to Implement the Backpropagation Algorithm From Scratch In Python" height="45" width="45"></a>		<a title="How to Implement the Backpropagation Algorithm From Scratch In Python" href="http://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/">How to Implement the Backpropagation Algorithm From Scratch In Python</a>
		<span class="meta">November 7, 2016</span>
		<div class="fix"></div>
	</li>
		<li style="border-bottom: 0px none;">
		<a href="http://machinelearningmastery.com/a-tour-of-machine-learning-algorithms/" title="A Tour of Machine Learning Algorithms"><img src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/ensemble-150x150.png" class="thumbnail wp-post-image" alt="Ensemble Learning Method" title="A Tour of Machine Learning Algorithms" height="45" width="45"></a>		<a title="A Tour of Machine Learning Algorithms" href="http://machinelearningmastery.com/a-tour-of-machine-learning-algorithms/">A Tour of Machine Learning Algorithms</a>
		<span class="meta">November 25, 2013</span>
		<div class="fix"></div>
	</li>
	                </ul>
                                                                
            </div><!-- /.boxes -->

        </div><!-- /wooTabs -->

        </div>         </aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			<p>© 2017 Machine Learning Mastery. All Rights Reserved. </p>		</div>

		<div id="credit" class="col-right">
			<p></p><p>
<a href="http://machinelearningmastery.com/privacy/">Privacy</a> | 
<a href="http://machinelearningmastery.com/contact/">Contact</a> |
<a href="http://machinelearningmastery.com/about/">About</a>
</p><p></p>		</div>

	</footer>

	
	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script type="text/javascript" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/comment-reply.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"0facafc3e8"};
/* ]]> */
</script>
<script type="text/javascript" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/frontend.js"></script>
<script type="text/javascript" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/wp-embed.js"></script>
<script type="text/javascript" src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/form.js"></script>

<div style="position: absolute; right: 0px; left: 0px; bottom: 0px; top: 0px; z-index: 2147483646; background: black none repeat scroll 0% 0%; width: 100%; opacity: 0.5; display: none; height: 59089px;"></div><iframe src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/a_002.html" style="position: absolute; left: 0px; top: 0px; width: 100%; display: none; border: medium none; z-index: 2147483647; height: 951px;"></iframe><iframe src="Sequence%20Classification%20with%20LSTM%20Recurrent%20Neural%20Networks%20in%20Python%20with%20Keras%20-%20Machine%20Learning%20Mastery_files/a_002.html" style="position: absolute; left: 0px; top: 0px; width: 100%; display: none; border: medium none; z-index: 2147483647; height: 951px;"></iframe><div class="drip-tab-container">
  <div id="drip-2211" class="drip-tab bottom right no-image">
    <div id="drip-header-2211" class="drip-header">
      <a href="#" id="drip-toggle-2211" class="drip-toggle">
        <h2 id="drip-teaser-2211">Get Your Start in Machine Learning</h2>
        <span id="drip-tab-up-2211" class="drip-arrow up">
          <svg width="12px" height="8px" viewBox="1362 659 12 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
            <polygon id="right_angle" stroke="none" fill="#FFFFFF" fill-rule="evenodd" transform="translate(1368.000000, 662.703125) rotate(-90.000000) translate(-1368.000000, -662.703125) " points="1364.29688 667.296875 1368.89062 662.703125 1364.29688 658.109375 1365.70312 656.703125 1371.70312 662.703125 1365.70312 668.703125"></polygon>
          </svg>
        </span>
        <span id="drip-tab-down-2211" class="drip-arrow down" style="display: none"></span>
      </a>
    </div>

    <div id="drip-content-2211" class="drip-content drip-clearfix" style="height: auto; bottom: -544px;">
      <div id="drip-form-panel-2211" class="drip-panel" style="display: block;">
        <a id="drip-close-2211" class="drip-close">×</a>
        <h3 id="drip-content-header-2211">Get Your Start in Machine Learning</h3>
        <div id="drip-scroll-2211" class="drip-scroll">
          <div class="drip-clearfix">
            
            <div class="drip-description">You can master applied Machine Learning&nbsp;<br>
<strong>without the math or fancy degree</strong>.<br>
Find out how in this <em>free</em>&nbsp;and <em>practical</em> email course.</div>
          </div>
          <form id="drip-form-2211">
            <div style="display: none">
              <input name="form_id" value="2211" type="hidden">
            </div>
            <dl class="no-labels">
              
                <dt>Email Address</dt>
                <dd class="drip-clearfix">
                  
                    <input name="fields[email]" placeholder="Email Address" class="drip-text-field" type="email">
                    <div id="drip-errors-for-email-2211" class="drip-errors"></div>
                  
                </dd>
              
            </dl>
            <div class="form-controls">
              <input name="submit" value="Start My Email Course" id="drip-submit-2211" class="drip-submit-button" type="submit">
            </div>
          </form>
        </div>
      </div>

      <div id="drip-success-panel-2211" class="drip-success drip-panel drip-clearfix" style="display: none">
        <a id="drip-hide-2211" class="drip-close">×</a>
        <h3>Thank you for signing up!</h3>
        <p class="drip-description">Please check your email and click the link provided to confirm your subscription.</p>
      </div>

      
    </div>
  </div>
</div></body></html>